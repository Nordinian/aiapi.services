"use strict";

Object.defineProperty(exports, "__esModule", {
    value: !0
}), exports.getLabelPosition = exports.isInRange = exports.clampRadian = void 0;

const vrender_core_1 = require("@visactor/vrender-core"), vutils_1 = require("@visactor/vutils"), clampRadian = (angle = 0) => {
    if (angle < 0) for (;angle < 0; ) angle += vutils_1.tau; else if (angle > 0) for (;angle > vutils_1.tau; ) angle -= vutils_1.tau;
    return angle;
};

function isInRange(a, min, max) {
    return !(0, vutils_1.isLess)(a, min, 0, 1e-6) && !(0, vutils_1.isGreater)(a, max, 0, 1e-6);
}

function getLabelPosition(tickPosition, tickVector, text, style) {
    const labelBounds = (0, vrender_core_1.getTextBounds)(Object.assign({
        text: text
    }, style)), width = labelBounds.width(), height = labelBounds.height(), angle = (0, 
    exports.clampRadian)(Math.atan2(tickVector[1], tickVector[0])) - Math.PI, PI_3_4 = 3 * Math.PI / 4, PI_1_4 = Math.PI / 4, PI_1_2 = Math.PI / 2, baseX = tickPosition.x;
    let dx = 0;
    dx = isInRange(angle, -PI_3_4, -PI_1_4) ? ((angle + PI_3_4) / PI_1_2 - .5) * width : isInRange(angle, PI_1_4, PI_3_4) ? (.5 - (angle - PI_1_4) / PI_1_2) * width : Math.cos(angle) >= 0 ? .5 * width : .5 * -width;
    const x = baseX - dx, baseY = tickPosition.y;
    let dy = 0;
    dy = isInRange(angle, -PI_3_4, -PI_1_4) ? .5 * -height : isInRange(angle, PI_1_4, PI_3_4) ? .5 * height : Math.cos(angle) >= 0 ? (.5 - (PI_1_4 - angle) / PI_1_2) * height : (.5 - (0, 
    exports.clampRadian)(angle - PI_3_4) / PI_1_2) * height;
    return {
        x: x,
        y: baseY - dy
    };
}

exports.clampRadian = clampRadian, exports.isInRange = isInRange, exports.getLabelPosition = getLabelPosition;
//# sourceMappingURL=util.js.map