{"version":3,"sources":["../src/component/tooltip/handler/base.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,mBAAmB,EAAE,oBAAoB,EAAE,MAAM,wBAAwB,CAAC;AAGnF,OAAO,EAAE,eAAe,EAAE,MAAM,aAAa,CAAC;AAK9C,OAAO,EAAE,aAAa,EAAE,MAAM,mBAAmB,CAAC;AAalD,OAAO,EAAE,sBAAsB,EAAE,QAAQ,EAAE,MAAM,gBAAgB,CAAC;AAClE,OAAO,EAAE,6BAA6B,EAAE,yBAAyB,EAAE,uBAAuB,EAAE,MAAM,kBAAkB,CAAC;AACrH,OAAO,EAAE,cAAc,EAAE,MAAM,iBAAiB,CAAC;AACjD,OAAO,EAAE,qBAAqB,EAAE,MAAM,kBAAkB,CAAC;AAKzD,OAAO,EAAE,aAAa,EAAE,MAAM,qBAAqB,CAAC;AAIpD,OAAO,EACL,QAAQ,EACR,QAAQ,EACR,aAAa,EACb,OAAO,EACP,QAAQ,EACR,KAAK,EACL,mBAAmB,EACnB,WAAW,EACZ,MAAM,kBAAkB,CAAC;AAK1B,OAAO,EAAE,oBAAoB,EAAE,MAAM,mBAAmB,CAAC;AAqBzD,MAAM,OAAgB,kBAAkB;IAatC,IAAW,EAAE;QACX,OAAO,IAAI,CAAC,GAAG,CAAC;IAClB,CAAC;IAGD,IAAW,GAAG;QACZ,OAAO,IAAI,CAAC,IAAI,CAAC;IACnB,CAAC;IA0BD,YAAY,SAAiB,EAAE,SAAkB;QA1CvC,aAAQ,GAAG,IAAI,CAAC;QAQhB,QAAG,GAAG,EAAE,CAAC;QAWT,gBAAW,GAA8B,IAAI,CAAC;QAkB9C,gBAAW,GAAY,KAAK,CAAC;QAevC,gBAAW,GAAG,CAAC,UAA6B,EAAE,IAAiB,EAAE,MAA4B,EAAE,EAAE;;YAC/F,IAAI,kBAAkB,GAAG,CAAC,CAAC,MAAM,CAAC,kBAAkB,CAAC;YACrD,IAAI,CAAC,MAAM,CAAC,kBAAkB,IAAI,CAAA,MAAA,IAAI,CAAC,mBAAmB,0CAAE,UAAU,MAAK,UAAU,EAAE;gBACrF,kBAAkB,GAAG,KAAK,CAAC;gBAC3B,IAAI,CAAC,oBAAoB,EAAE,CAAC;aAC7B;YAED,IAAI,kBAAkB,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,mBAAmB,EAAE;gBACzE,OAAO,IAAI,CAAC,qBAAqB,CAAC,kBAAkB,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;aACrE;YACD,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,MAAM,EAAE,kBAAkB,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;QAChF,CAAC,CAAC;QAMQ,mBAAc,GAAsB,CAC5C,OAAgB,EAChB,MAA4B,EAC5B,kBAA4B,EAC5B,UAA8B,EAC9B,IAAkB,EAClB,EAAE;;YACF,MAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,EAAkB,CAAC;YAC9D,IAAI,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW,EAAE;gBACpC,OAAO,aAAa,CAAC,MAAM,CAAC;aAC7B;YAGD,IAAI,CAAC,OAAO,EAAE;gBACZ,IAAI,CAAC,cAAc,EAAE,CAAC;gBAGtB,IAAI,WAAW,CAAC,OAAO,EAAE;oBACvB,OAAO,MAAA,MAAA,MAAA,WAAW,CAAC,OAAO,EAAC,WAAW,mDAAG,MAAM,CAAC,mCAAI,aAAa,CAAC,OAAO,CAAC;iBAC3E;gBAED,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;gBACnC,OAAO,aAAa,CAAC,OAAO,CAAC;aAC9B;YAED,IAAI,KAAK,CAAC,UAAU,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE;gBACpC,OAAO,aAAa,CAAC,MAAM,CAAC;aAC7B;YAGD,IAAI,IAA8B,CAAC;YACnC,IAAI,kBAAkB,IAAI,IAAI,CAAC,cAAc,EAAE;gBAC7C,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC;aAC5B;iBAAM;gBACL,IAAI,GAAG,qBAAqB,CAC1B,UAAW,EACX,WAAW,EACV,MAA0B,CAAC,KAAgB,EAC3C,MAA+B,CAAC,aAAa,CAC/C,CAAC;gBACF,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;aAC5B;YAED,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;gBAC1B,OAAO,aAAa,CAAC,MAAM,CAAC;aAC7B;YAGD,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,OAAO,MAAA,MAAA,MAAA,IAAI,CAAC,OAAO,EAAC,WAAW,mDAAG,UAAW,EAAE,IAAK,EAAE,MAAM,CAAC,mCAAI,aAAa,CAAC,OAAO,CAAC;aACxF;YAGD,MAAM,OAAO,GAAG,IAAI,CAAC,UAAW,CAAoB,CAAC;YACrD,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,aAAa,CAAC,MAAM,CAAC;aAC7B;YAGD,IAAI,aAAyC,CAAC;YAC9C,IAAI,kBAAkB,IAAI,IAAI,CAAC,mBAAmB,EAAE;gBAClD,aAAa,GAAG,IAAI,CAAC,mBAAmB,CAAC;aAC1C;iBAAM;gBACL,aAAa,GAAG,IAAI,CAAC,wBAAwB,CAAC,OAAO,EAAE,IAAK,EAAE,MAAM,CAAC,CAAC;gBACtE,aAAa,CAAC,KAAK,GAAG,MAAA,MAAA,OAAO,CAAC,WAAW,wDAAG,aAAa,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,mCAAI,aAAa,CAAC,KAAK,CAAC;gBACtG,aAAa,CAAC,OAAO,GAAG,MAAA,MAAA,OAAO,CAAC,aAAa,wDAAG,aAAa,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,mCAAI,aAAa,CAAC,OAAO,CAAC;aAC/G;YAGD,IAAI,KAAK,CAAC,MAAA,aAAa,CAAC,KAAK,0CAAE,GAAG,CAAC,IAAI,KAAK,CAAC,MAAA,aAAa,CAAC,KAAK,0CAAE,KAAK,CAAC,IAAI,CAAC,CAAA,MAAA,aAAa,CAAC,OAAO,0CAAE,MAAM,CAAA,EAAE;gBAC1G,OAAO,aAAa,CAAC,MAAM,CAAC;aAC7B;YAED,IAAI,CAAC,mBAAmB,GAAG,aAAa,CAAC;YACzC,OAAO,IAAI,CAAC,sBAAsB,CAAC,CAAC,CAAC,kBAAkB,EAAE,IAAK,EAAE,MAAM,CAAC,CAAC;QAC1E,CAAC,CAAC;QAMQ,2BAAsB,GAA8B,CAC5D,kBAA2B,EAC3B,IAAiB,EACjB,MAA4B,EAC5B,EAAE;;YACF,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,OAAO,aAAa,CAAC,MAAM,CAAC;aAC7B;YAED,MAAM,KAAK,GAAG,MAAM,CAAC,KAAmB,CAAC;YACzC,MAAM,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC;YACjC,MAAM,aAAa,GAAG,IAAI,CAAC,mBAAmB,CAAC;YAC/C,IAAI,CAAC,IAAI,IAAI,CAAC,aAAa,EAAE;gBAC3B,OAAO,aAAa,CAAC,MAAM,CAAC;aAC7B;YAED,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,IAAI,CAAC,iBAAiB,IAAI,IAAI,CAAC,yBAAyB,CAAC,MAAM,CAAC,EAAE;oBACrE,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;wBAC1B,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;wBAC7B,IAAI,CAAC,kBAAkB,GAAG,UAAU,CAAC,GAAG,EAAE;4BACxC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;wBAChC,CAAC,EAAE,GAAG,CAAsB,CAAC;qBAC9B;oBACD,OAAO,aAAa,CAAC,OAAO,CAAC;iBAC9B;gBACD,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;gBAC9B,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;gBAC/B,YAAY,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;gBACtC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,0CAA0C,CAAC,MAAM,CAAC,CAAC;aACtF;YAED,MAAM,UAAU,GAAG,aAAa,CAAC,UAAU,CAAC;YAG5C,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,OAAO,MAAA,MAAA,MAAA,IAAI,CAAC,OAAO,EAAC,WAAW,mDAAG,UAAU,EAAE,IAAI,EAAE,MAAM,CAAC,mCAAI,aAAa,CAAC,OAAO,CAAC;aACtF;YAGD,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;YACjC,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,aAAa,CAAC,MAAM,CAAC;aAC7B;YAGD,MAAM,QAAQ,GAAG,IAAI,CAAC,yBAAyB,CAC7C,aAAa,EACb,MAAM,EACN,IAAI,CAAC,kBAAkB,CAAC,aAAa,EAAE,kBAAkB,CAAC,CAC3D,CAAC;YACF,aAAa,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAClC,IAAI,OAAO,CAAC,cAAc,EAAE;gBAC1B,aAAa,CAAC,QAAQ,GAAG,OAAO,CAAC,cAAc,CAAC,aAAa,CAAC,QAAQ,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;aACvF;YAGD,IAAI,cAAc,GAAG,CAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,OAAO,MAAK,KAAK,CAAC;YAChD,IACE,CAAC,IAAI;gBACL,KAAK,CAAC,IAAI,KAAK,YAAY;gBAC3B,CAAC,aAAa,CAAC,OAAO;gBACtB,CAAC,CAAC,aAAa,CAAC,KAAK,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,EAChD;gBACA,cAAc,GAAG,KAAK,CAAC;aACxB;YAED,IAAI,CAAC,cAAc,CACjB,cAAc,kCAET,MAAM,KACT,kBAAkB,KAEpB,aAAa,CACd,CAAC;YACF,OAAO,aAAa,CAAC,OAAO,CAAC;QAC/B,CAAC,CAAC;QA6EQ,6BAAwB,GAAG,CACnC,OAAwB,EACxB,IAAiB,EACjB,MAA4B,EACZ,EAAE;YAElB,MAAM,cAAc,GAAG,sBAAsB,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;YAG7E,IAAI,cAAc,GAAqC,IAAI,CAAC;YAC5D,cAAc,GAAG,cAAc,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;YAEvD,MAAM,aAAa,mCACd,cAAc,KACjB,OAAO,EAAE,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,cAAc,KAAK,KAAK,CAAC,CAAC,CAAC,KAAK,EACnE,UAAU,EAAE,OAAO,CAAC,UAAU,EAC9B,IAAI,GACL,CAAC;YAEF,OAAO,aAAa,CAAC;QACvB,CAAC,CAAC;QAKQ,8BAAyB,GAAG,CACpC,aAA6B,EAC7B,MAA4B,EAC5B,cAA0C,EAClB,EAAE;;YAC1B,MAAM,KAAK,GAAG,MAAM,CAAC,KAAmB,CAAC;YAEzC,MAAM,eAAe,GAAG;gBACtB,CAAC,EAAE,QAAQ;gBACX,CAAC,EAAE,QAAQ;aACZ,CAAC;YAEF,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC;YAC1C,MAAM,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC;YACxC,IAAI,CAAC,WAAW,EAAE;gBAChB,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;gBACvC,OAAO,eAAe,CAAC;aACxB;YAED,MAAM,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,aAAa,CAAC;YAC3C,MAAM,OAAO,GAAG,WAAW,CAAC,UAAU,CAAC,CAAC;YACxC,MAAM,QAAQ,GAAG,sBAAsB,CAAC,OAAO,CAAC,QAAQ,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;YACxE,MAAM,YAAY,GAAG,sBAAsB,CAAC,OAAO,CAAC,YAAY,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;YAChF,MAAM,oBAAoB,GAAG,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;YACjE,MAAM,EAAE,KAAK,EAAE,eAAe,GAAG,CAAC,EAAE,MAAM,EAAE,gBAAgB,GAAG,CAAC,EAAE,GAAG,cAAc,aAAd,cAAc,cAAd,cAAc,GAAI,EAAE,CAAC;YAE1F,MAAM,QAAQ,GAAG,WAAW,CAAC,UAAU,KAAK,QAAQ,CAAC;YACrD,MAAM,UAAU,GAAG,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,KAAK,0CAAE,aAAa,EAAE,CAAC;YAClD,MAAM,WAAW,GAAG,MAAA,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAE,KAAK,mCAAI,mBAAmB,CAAC;YAC7D,MAAM,YAAY,GAAG,MAAA,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAE,MAAM,mCAAI,oBAAoB,CAAC;YAChE,IAAI,eAAe,GAAG,KAAK,CAAC;YAE5B,MAAM,aAAa,GAAG;gBACpB,KAAK,EAAE,CAAC;gBACR,MAAM,EAAE,CAAC;aACV,CAAC;YACF,IAAI,iBAAiB,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACvC,IAAI,wBAAwB,GAAqB,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YAChE,IAAI,iBAAiB,GAAG,CAAC,CAAC;YAC1B,IAAI,yBAAyB,GAAG,CAAC,CAAC;YAElC,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE;gBAEpD,aAAa,CAAC,KAAK,GAAG,MAAM,CAAC,UAAU,CAAC;gBACxC,aAAa,CAAC,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC;gBAE1C,IAAI,CAAC,QAAQ,EAAE;oBACb,wBAAwB,GAAG,MAAA,oBAAoB,aAApB,oBAAoB,uBAApB,oBAAoB,CAAE,qBAAqB,EAAE,mCAAI,eAAe,CAAC;oBAC5F,MAAM,YAAY,GAAG,CAAC,MAAA,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,mCAAI,IAAI,CAAC,eAAe,CAAgB,CAAC;oBACzF,MAAM,gBAAgB,GAAG,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,qBAAqB,EAAE,CAAC;oBAC/D,iBAAiB,GAAG;wBAClB,CAAC,EAAE,gBAAgB,CAAC,CAAC,GAAG,wBAAwB,CAAC,CAAC;wBAClD,CAAC,EAAE,gBAAgB,CAAC,CAAC,GAAG,wBAAwB,CAAC,CAAC;qBACnD,CAAC;oBACF,iBAAiB,GAAG,QAAQ,CAAC,YAAY,EAAE,gBAAgB,CAAC,CAAC;oBAC7D,yBAAyB,GAAG,QAAQ,CAAC,oBAAoB,EAAE,wBAAmC,CAAC,CAAC;iBACjG;aACF;iBAAM;gBACL,aAAa,CAAC,KAAK,GAAG,WAAW,CAAC;gBAClC,aAAa,CAAC,MAAM,GAAG,YAAY,CAAC;aACrC;YACD,MAAM,gBAAgB,GAAG,yBAAyB,GAAG,iBAAiB,CAAC;YAGvE,IAAI,IAAwB,CAAC;YAC7B,IAAI,GAAuB,CAAC;YAC5B,IAAI,KAAyB,CAAC;YAC9B,IAAI,MAA0B,CAAC;YAC/B,IAAI,QAAQ,CAAC,QAAQ,CAAC,EAAE;gBACtB,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,QAAmC,CAAC;gBAC/G,IAAI,GAAG,6BAA6B,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;gBACrD,GAAG,GAAG,6BAA6B,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;gBACnD,KAAK,GAAG,6BAA6B,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;gBACvD,MAAM,GAAG,6BAA6B,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;aAC1D;iBAAM,IACL,OAAO,CAAC,QAAQ,CAAC;gBACjB,YAAY,cAAgC;gBAC5C,aAAa,CAAC,UAAU,KAAK,MAAM,EACnC;gBACA,eAAe,GAAG,IAAI,CAAC;gBACvB,MAAM,OAAO,GAAG,MAAM,CAAC,IAAgB,CAAC;gBACxC,MAAM,KAAK,GAAG,MAAM,CAAC,KAAe,CAAC;gBACrC,MAAM,MAAM,GAAG,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,SAAS,EAAgB,CAAC;gBAClD,MAAM,UAAU,GAA4B,KAAO,aAAP,KAAK,uBAAL,KAAK,CAAI,mBAAmB,EAAE,CAAC;gBAC3E,IAAI,MAAM,IAAI,UAAU,EAAE;oBACxB,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,MAAM,CAAC;oBAChC,EAAE,IAAI,UAAU,CAAC,CAAC,CAAC;oBACnB,EAAE,IAAI,UAAU,CAAC,CAAC,CAAC;oBACnB,EAAE,IAAI,UAAU,CAAC,CAAC,CAAC;oBACnB,EAAE,IAAI,UAAU,CAAC,CAAC,CAAC;oBACnB,QAAQ,yBAAyB,CAAC,QAAQ,CAAC,EAAE;wBAC3C,KAAK,MAAM;4BACT,IAAI,GAAG,EAAE,GAAG,eAAe,GAAG,gBAAgB,GAAG,OAAO,CAAC;4BACzD,MAAM;wBACR,KAAK,OAAO;4BACV,IAAI,GAAG,EAAE,GAAG,OAAO,CAAC;4BACpB,MAAM;wBACR,KAAK,QAAQ;4BACX,IAAI,GAAG,CAAC,EAAE,GAAG,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,eAAe,GAAG,gBAAgB,CAAC,GAAG,CAAC,CAAC;4BAChE,MAAM;qBACT;oBACD,QAAQ,uBAAuB,CAAC,QAAQ,CAAC,EAAE;wBACzC,KAAK,KAAK;4BACR,GAAG,GAAG,EAAE,GAAG,gBAAgB,GAAG,gBAAgB,GAAG,OAAO,CAAC;4BACzD,MAAM;wBACR,KAAK,QAAQ;4BACX,GAAG,GAAG,EAAE,GAAG,OAAO,CAAC;4BACnB,MAAM;wBACR,KAAK,QAAQ;4BACX,GAAG,GAAG,CAAC,EAAE,GAAG,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,gBAAgB,GAAG,gBAAgB,CAAC,GAAG,CAAC,CAAC;4BAChE,MAAM;qBACT;iBACF;aACF;YAGD,IAAI,CAAS,CAAC;YACd,IAAI,CAAS,CAAC;YAEd,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,KAAY,CAAC;YAC1C,IAAI,aAAa,CAAC,IAAI,CAAC,EAAE;gBACvB,CAAC,GAAG,IAAI,CAAC;aACV;iBAAM,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;gBAC/B,CAAC,GAAG,WAAW,GAAG,eAAe,GAAG,gBAAgB,GAAG,KAAK,CAAC;aAC9D;iBAAM;gBACL,MAAM,EAAE,GAAG,OAAO,CAAC;gBACnB,QAAQ,yBAAyB,CAAC,QAAgC,EAAE,OAAO,CAAC,EAAE;oBAC5E,KAAK,QAAQ;wBACX,CAAC,GAAG,EAAE,GAAG,CAAC,eAAe,GAAG,gBAAgB,CAAC,GAAG,CAAC,CAAC;wBAClD,MAAM;oBACR,KAAK,MAAM;wBACT,CAAC,GAAG,EAAE,GAAG,eAAe,GAAG,gBAAgB,GAAG,OAAO,CAAC;wBACtD,MAAM;oBACR,KAAK,OAAO;wBACV,CAAC,GAAG,EAAE,GAAG,OAAO,CAAC;wBACjB,MAAM;iBACT;aACF;YACD,IAAI,aAAa,CAAC,GAAG,CAAC,EAAE;gBACtB,CAAC,GAAG,GAAG,CAAC;aACT;iBAAM,IAAI,aAAa,CAAC,MAAM,CAAC,EAAE;gBAChC,CAAC,GAAG,YAAY,GAAG,gBAAgB,GAAG,gBAAgB,GAAG,MAAM,CAAC;aACjE;iBAAM;gBACL,MAAM,EAAE,GAAG,OAAO,CAAC;gBACnB,QAAQ,uBAAuB,CAAC,QAAgC,EAAE,QAAQ,CAAC,EAAE;oBAC3E,KAAK,QAAQ;wBACX,CAAC,GAAG,EAAE,GAAG,CAAC,gBAAgB,GAAG,gBAAgB,CAAC,GAAG,CAAC,CAAC;wBACnD,MAAM;oBACR,KAAK,KAAK;wBACR,CAAC,GAAG,EAAE,GAAG,gBAAgB,GAAG,gBAAgB,GAAG,OAAO,CAAC;wBACvD,MAAM;oBACR,KAAK,QAAQ;wBACX,CAAC,GAAG,EAAE,GAAG,OAAO,CAAC;wBACjB,MAAM;iBACT;aACF;YAED,CAAC,IAAI,iBAAiB,CAAC;YACvB,CAAC,IAAI,iBAAiB,CAAC;YACvB,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;gBAC5B,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC;gBACzB,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC;aAC1B;YACD,CAAC,IAAI,yBAAyB,CAAC;YAC/B,CAAC,IAAI,yBAAyB,CAAC;YAG/B,MAAM,EAAE,KAAK,EAAE,cAAc,EAAE,MAAM,EAAE,eAAe,EAAE,GAAG,aAAa,CAAC;YAEzE,MAAM,SAAS,GAAG,GAAG,EAAE,CAAC,CAAC,GAAG,yBAAyB,GAAG,wBAAwB,CAAC,CAAC,GAAG,CAAC,CAAC;YACvF,MAAM,UAAU,GAAG,GAAG,EAAE,CACtB,CAAC,CAAC,GAAG,eAAe,CAAC,GAAG,yBAAyB,GAAG,wBAAwB,CAAC,CAAC,GAAG,cAAc,CAAC;YAClG,MAAM,QAAQ,GAAG,GAAG,EAAE,CAAC,CAAC,GAAG,yBAAyB,GAAG,wBAAwB,CAAC,CAAC,GAAG,CAAC,CAAC;YACtF,MAAM,WAAW,GAAG,GAAG,EAAE,CACvB,CAAC,CAAC,GAAG,gBAAgB,CAAC,GAAG,yBAAyB,GAAG,wBAAwB,CAAC,CAAC,GAAG,eAAe,CAAC;YAEpG,MAAM,eAAe,GAAG,GAAG,EAAE;gBAC3B,IAAI,SAAS,EAAE,EAAE;oBAEf,IAAI,eAAe,EAAE;wBACnB,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC,GAAG,yBAAyB,CAAC;qBAC7D;yBAAM;wBACL,IAAI,yBAAyB,CAAC,QAAgC,EAAE,OAAO,CAAC,KAAK,QAAQ,EAAE;4BACrF,CAAC,IAAI,OAAO,GAAG,eAAe,GAAG,CAAC,CAAC;yBACpC;6BAAM;4BACL,CAAC,IAAI,OAAO,GAAG,CAAC,GAAG,eAAe,CAAC;yBACpC;qBACF;iBACF;YACH,CAAC,CAAC;YACF,MAAM,cAAc,GAAG,GAAG,EAAE;gBAC1B,IAAI,SAAS,EAAE,EAAE;oBAEf,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC,GAAG,yBAAyB,CAAC;iBAC7D;YACH,CAAC,CAAC;YACF,MAAM,gBAAgB,GAAG,GAAG,EAAE;gBAC5B,IAAI,UAAU,EAAE,EAAE;oBAEhB,IAAI,eAAe,EAAE;wBACnB,CAAC,GAAG,CAAC,cAAc,GAAG,wBAAwB,CAAC,CAAC,CAAC,GAAG,yBAAyB,GAAG,eAAe,CAAC;qBACjG;yBAAM;wBACL,IAAI,yBAAyB,CAAC,QAAgC,EAAE,OAAO,CAAC,KAAK,QAAQ,EAAE;4BACrF,CAAC,IAAI,OAAO,GAAG,eAAe,GAAG,CAAC,CAAC;yBACpC;6BAAM;4BACL,CAAC,IAAI,OAAO,GAAG,CAAC,GAAG,eAAe,CAAC;yBACpC;qBACF;iBACF;YACH,CAAC,CAAC;YACF,MAAM,eAAe,GAAG,GAAG,EAAE;gBAC3B,IAAI,UAAU,EAAE,EAAE;oBAEhB,CAAC,GAAG,CAAC,cAAc,GAAG,wBAAwB,CAAC,CAAC,CAAC,GAAG,yBAAyB,GAAG,eAAe,CAAC;iBACjG;YACH,CAAC,CAAC;YACF,MAAM,cAAc,GAAG,GAAG,EAAE;gBAC1B,IAAI,QAAQ,EAAE,EAAE;oBAEd,IAAI,eAAe,EAAE;wBACnB,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC,GAAG,yBAAyB,CAAC;qBAC7D;yBAAM;wBACL,IAAI,uBAAuB,CAAC,QAAgC,EAAE,QAAQ,CAAC,KAAK,QAAQ,EAAE;4BACpF,CAAC,IAAI,OAAO,GAAG,gBAAgB,GAAG,CAAC,CAAC;yBACrC;6BAAM;4BACL,CAAC,IAAI,OAAO,GAAG,CAAC,GAAG,gBAAgB,CAAC;yBACrC;qBACF;iBACF;YACH,CAAC,CAAC;YACF,MAAM,aAAa,GAAG,GAAG,EAAE;gBACzB,IAAI,QAAQ,EAAE,EAAE;oBAEd,CAAC,GAAG,CAAC,GAAG,wBAAwB,CAAC,CAAC,GAAG,yBAAyB,CAAC;iBAChE;YACH,CAAC,CAAC;YACF,MAAM,iBAAiB,GAAG,GAAG,EAAE;gBAC7B,IAAI,WAAW,EAAE,EAAE;oBAEjB,IAAI,eAAe,EAAE;wBACnB,CAAC,GAAG,CAAC,eAAe,GAAG,wBAAwB,CAAC,CAAC,CAAC,GAAG,yBAAyB,GAAG,gBAAgB,CAAC;qBACnG;yBAAM;wBACL,IAAI,uBAAuB,CAAC,QAAgC,EAAE,QAAQ,CAAC,KAAK,QAAQ,EAAE;4BACpF,CAAC,IAAI,OAAO,GAAG,gBAAgB,GAAG,CAAC,CAAC;yBACrC;6BAAM;4BACL,CAAC,IAAI,OAAO,GAAG,CAAC,GAAG,gBAAgB,CAAC;yBACrC;qBACF;iBACF;YACH,CAAC,CAAC;YACF,MAAM,gBAAgB,GAAG,GAAG,EAAE;gBAC5B,IAAI,WAAW,EAAE,EAAE;oBAEjB,CAAC,GAAG,CAAC,eAAe,GAAG,wBAAwB,CAAC,CAAC,CAAC,GAAG,yBAAyB,GAAG,gBAAgB,CAAC;iBACnG;YACH,CAAC,CAAC;YAGF,QAAQ,yBAAyB,CAAC,QAAgC,EAAE,OAAO,CAAC,EAAE;gBAC5E,KAAK,QAAQ;oBACX,IAAI,SAAS,EAAE,EAAE;wBACf,eAAe,EAAE,CAAC;wBAClB,eAAe,EAAE,CAAC;qBACnB;yBAAM;wBACL,gBAAgB,EAAE,CAAC;wBACnB,cAAc,EAAE,CAAC;qBAClB;oBACD,MAAM;gBACR,KAAK,MAAM;oBACT,eAAe,EAAE,CAAC;oBAClB,eAAe,EAAE,CAAC;oBAClB,MAAM;gBACR,KAAK,OAAO;oBACV,gBAAgB,EAAE,CAAC;oBACnB,cAAc,EAAE,CAAC;oBACjB,MAAM;aACT;YAED,QAAQ,uBAAuB,CAAC,QAAgC,EAAE,QAAQ,CAAC,EAAE;gBAC3E,KAAK,QAAQ;oBACX,IAAI,QAAQ,EAAE,EAAE;wBACd,cAAc,EAAE,CAAC;wBACjB,gBAAgB,EAAE,CAAC;qBACpB;yBAAM;wBACL,iBAAiB,EAAE,CAAC;wBACpB,aAAa,EAAE,CAAC;qBACjB;oBACD,MAAM;gBACR,KAAK,KAAK;oBACR,cAAc,EAAE,CAAC;oBACjB,gBAAgB,EAAE,CAAC;oBACnB,MAAM;gBACR,KAAK,QAAQ;oBACX,iBAAiB,EAAE,CAAC;oBACpB,aAAa,EAAE,CAAC;oBAChB,MAAM;aACT;YAED,MAAM,MAAM,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;YACxB,IAAI,CAAC,qBAAqB,GAAG,MAAM,CAAC;YACpC,IAAI,CAAC,iBAAiB,GAAG,EAAE,KAAK,EAAE,eAAe,EAAE,MAAM,EAAE,gBAAgB,EAAE,CAAC;YAC9E,OAAO,MAAM,CAAC;QAChB,CAAC,CAAC;QA3kBA,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;QAC5B,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC,SAAS,EAAS,CAAC;QACjD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;QACnC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;QACvE,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC,WAAW,EAAE,CAAC;QACzC,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC;QACrB,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAkLD,WAAW,CAAC,MAA4B;QACtC,OAAO,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IAC3C,CAAC;IAED,OAAO;;QACL,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,MAAM,IAAI,GAAG,MAAA,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,mCAAI,EAAE,CAAC;QAE7C,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,MAAA,MAAA,IAAI,CAAC,OAAO,EAAC,OAAO,kDAAI,CAAC;YACzB,OAAO;SACR;QAED,IAAI,CAAC,cAAc,EAAE,CAAC;QAEtB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IAC1B,CAAC;IAES,cAAc;QACtB,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC5B,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC/B,CAAC;IAES,oBAAoB;QAC5B,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;QAChC,IAAI,CAAC,mBAAmB,GAAG,SAAS,CAAC;IACvC,CAAC;IAES,qBAAqB;QAC7B,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;QAC9B,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;QAC/B,YAAY,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QACtC,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC,CAAC;QAC7B,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;QACvC,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;QACvC,IAAI,CAAC,iBAAiB,GAAG,SAAS,CAAC;IACrC,CAAC;IASS,SAAS,CAAC,QAAa;QAC/B,MAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;QAC9C,IAAI,IAAY,CAAC;QACjB,IAAI,QAAQ,CAAC,WAAW,CAAC,gBAAgB,CAAC,EAAE;YAC1C,IAAI,GAAG,WAAW,CAAC,gBAAgB,CAAC;SACrC;aAAM;YACL,IAAI,WAAW,CAAC,UAAU,KAAK,MAAM,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE;gBACxE,IAAI,GAAG,EAAE,CAAC;aACX;iBAAM;gBACL,IAAI,GAAG,EAAE,CAAC;aACX;SACF;QACD,OAAO,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;IAClC,CAAC;IAES,iBAAiB;;QACzB,MAAM,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;QAC7C,uCACK,eAAe,KAClB,OAAO,EAAE,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,CAAC,mCAAI,eAAe,CAAC,OAAO,EAC7C,OAAO,EAAE,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,CAAC,mCAAI,eAAe,CAAC,OAAO,IAC7C;IACJ,CAAC;IAkVS,kBAAkB,CAAC,aAA6B,EAAE,kBAA2B;;QACrF,IAAI,CAAC,kBAAkB,IAAI,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE;YAClD,MAAM,UAAU,GAAG,MAAA,MAAA,IAAI,CAAC,YAAY,0CAAE,QAAQ,EAAE,mCAAI,EAAE,CAAC;YACvD,IAAI,CAAC,WAAW,GAAG,oBAAoB,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,EAAE,UAAU,CAAC,CAAC;SAC/F;QACD,OAAO;YACL,KAAK,EAAE,MAAA,MAAA,IAAI,CAAC,WAAW,0CAAE,KAAK,0CAAE,KAAK;YACrC,MAAM,EAAE,MAAA,MAAA,IAAI,CAAC,WAAW,0CAAE,KAAK,0CAAE,MAAM;SACxC,CAAC;IACJ,CAAC;IAES,0CAA0C,CAAC,MAA4B;;QAC/E,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,GAAG,MAAM,CAAC,KAAK,CAAC;QAE9C,MAAM,eAAe,GAAG;YACtB,CAAC,EAAE,QAAQ;YACX,CAAC,EAAE,QAAQ;SACZ,CAAC;QAEF,MAAM,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC;QACxC,MAAM,QAAQ,GAAG,WAAW,CAAC,UAAU,KAAK,QAAQ,CAAC;QACrD,MAAM,oBAAoB,GAAG,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;QAEjE,IAAI,iBAAiB,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;QACvC,IAAI,wBAAwB,GAAqB,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;QAChE,IAAI,iBAAiB,GAAG,CAAC,CAAC;QAC1B,IAAI,yBAAyB,GAAG,CAAC,CAAC;QAElC,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE;YACpD,IAAI,CAAC,QAAQ,EAAE;gBACb,wBAAwB,GAAG,MAAA,oBAAoB,aAApB,oBAAoB,uBAApB,oBAAoB,CAAE,qBAAqB,EAAE,mCAAI,eAAe,CAAC;gBAC5F,MAAM,YAAY,GAAG,CAAC,MAAA,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,mCAAI,IAAI,CAAC,eAAe,CAAgB,CAAC;gBACzF,MAAM,gBAAgB,GAAG,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,qBAAqB,EAAE,CAAC;gBAC/D,iBAAiB,GAAG;oBAClB,CAAC,EAAE,gBAAgB,CAAC,CAAC,GAAG,wBAAwB,CAAC,CAAC;oBAClD,CAAC,EAAE,gBAAgB,CAAC,CAAC,GAAG,wBAAwB,CAAC,CAAC;iBACnD,CAAC;gBACF,iBAAiB,GAAG,QAAQ,CAAC,YAAY,EAAE,gBAAgB,CAAC,CAAC;gBAC7D,yBAAyB,GAAG,QAAQ,CAAC,oBAAoB,EAAE,wBAAmC,CAAC,CAAC;aACjG;SACF;QAED,CAAC,IAAI,iBAAiB,CAAC;QACvB,CAAC,IAAI,iBAAiB,CAAC;QACvB,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;YAC5B,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC;YACzB,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC;SAC1B;QACD,CAAC,IAAI,yBAAyB,CAAC;QAC/B,CAAC,IAAI,yBAAyB,CAAC;QAC/B,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;IAClB,CAAC;IAES,yBAAyB,CAAC,MAA4B;QAC9D,IAAI,CAAC,IAAI,CAAC,qBAAqB,IAAI,CAAC,IAAI,CAAC,iBAAiB,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;YACzF,OAAO,KAAK,CAAC;SACd;QACD,MAAM,EAAE,KAAK,EAAE,YAAY,EAAE,MAAM,EAAE,aAAa,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC;QAC9E,MAAM,EAAE,CAAC,EAAE,QAAQ,GAAG,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,qBAAqB,CAAC;QAEpE,MAAM,GAAG,GAAG,IAAI,CAAC,0CAA0C,CAAC,MAAM,CAAC,CAAC;QAEpE,IACE,WAAW,CACT,GAAG,EACH;YACE,EAAE,EAAE,QAAQ;YACZ,EAAE,EAAE,QAAQ;YACZ,EAAE,EAAE,QAAQ,GAAG,YAAY;YAC3B,EAAE,EAAE,QAAQ,GAAG,aAAa;SAC7B,EACD,KAAK,CACN,EACD;YACA,OAAO,IAAI,CAAC;SACb;QAGD,MAAM,CAAC,GAAG,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC;QACvC,MAAM,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,YAAY,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QAC5C,MAAM,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,aAAa,EAAE,CAAC;QAC7C,MAAM,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QAC7B,MAAM,MAAM,GAAG,IAAI,CAAC,qBAAqB,CAAC;QAE1C,OAAO,CACL,mBAAmB,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;YACjD,mBAAmB,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;YACjD,mBAAmB,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;YACjD,mBAAmB,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAClD,CAAC;IACJ,CAAC;IAES,iBAAiB,CAAC,IAAkB;QAC5C,OAAO,IAAI,CAAC,aAAoB,CAAC;IACnC,CAAC;IAED,mBAAmB;QACjB,OAAO,IAAI,CAAC,UAAU,CAAC;IACzB,CAAC;IAES,aAAa;QACrB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAExC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAQ,CAAC;QAChE,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,sBAAsB,CAAQ,CAAC;IAClF,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;CACF","file":"base.js","sourcesContent":["import { DEFAULT_CHART_WIDTH, DEFAULT_CHART_HEIGHT } from '../../../constant/base';\nimport type { Options } from './constants';\n// eslint-disable-next-line no-duplicate-imports\nimport { DEFAULT_OPTIONS } from './constants';\nimport type { Maybe, IPoint, ILayoutPoint } from '../../../typings';\n// eslint-disable-next-line no-duplicate-imports\nimport { TooltipPositionMode } from '../../../typings/tooltip/position';\n// eslint-disable-next-line no-duplicate-imports\nimport { isTrueBrowser } from '../../../util/env';\nimport type {\n  TooltipData,\n  IToolTipActual,\n  TooltipActiveType,\n  ITooltipHandler,\n  ITooltipPattern,\n  ITooltipPositionActual,\n  ITooltipPositionPattern\n} from '../../../typings/tooltip';\n// eslint-disable-next-line no-duplicate-imports\nimport type { TooltipFixedPosition } from '../../../typings/tooltip';\nimport type { BaseEventParams } from '../../../event/interface';\nimport { getTooltipPatternValue, getScale } from './utils/common';\nimport { getActualTooltipPositionValue, getHorizontalPositionType, getVerticalPositionType } from './utils/position';\nimport { getShowContent } from './utils/compose';\nimport { getTooltipSpecForShow } from './utils/get-spec';\nimport type { Tooltip, TooltipActualTitleContent } from '../tooltip';\nimport type { ISeries } from '../../../series/interface';\nimport type { ITooltipSpec, TooltipHandlerParams } from '../interface';\n// eslint-disable-next-line no-duplicate-imports\nimport { TooltipResult } from '../interface/common';\nimport type { IGroup } from '@visactor/vrender-core';\nimport type { AABBBounds } from '@visactor/vutils';\n// eslint-disable-next-line no-duplicate-imports\nimport {\n  isNumber,\n  isObject,\n  isValidNumber,\n  isValid,\n  throttle,\n  isNil,\n  polygonContainPoint,\n  pointInRect\n} from '@visactor/vutils';\nimport type { IElement } from '@visactor/vgrammar-core';\nimport type { ILayoutModel, IModel } from '../../../model/interface';\nimport type { Compiler } from '../../../compile/compiler';\nimport type { IContainerSize, TooltipAttributes } from '@visactor/vrender-components';\nimport { getTooltipAttributes } from './utils/attribute';\nimport type { DimensionEventParams } from '../../../event/events/dimension/interface';\nimport type { IChartOption } from '../../../chart/interface';\n\ntype ChangeTooltipFunc = (\n  visible: boolean,\n  params: TooltipHandlerParams,\n  changePositionOnly?: boolean,\n  activeType?: TooltipActiveType,\n  data?: TooltipData\n) => TooltipResult;\n\ntype ChangeTooltipPositionFunc = (\n  changePositionOnly: boolean,\n  data: TooltipData,\n  params: TooltipHandlerParams\n) => TooltipResult;\n\n/**\n * The tooltip handler class.\n */\nexport abstract class BaseTooltipHandler implements ITooltipHandler {\n  readonly type: string;\n\n  /** 是否可见 */\n  protected _visible = true;\n\n  // protected _style: ITooltipStyle = {};\n\n  protected _option: Options;\n\n  protected _chartOption: IChartOption;\n\n  protected _id = '';\n  public get id() {\n    return this._id;\n  }\n\n  protected _env;\n  public get env() {\n    return this._env;\n  }\n\n  protected _component: Tooltip;\n  protected _attributes?: TooltipAttributes | null = null;\n\n  protected _chartContainer: Maybe<HTMLElement>;\n  protected _compiler: Compiler;\n\n  protected _cacheViewSpec: ITooltipSpec | undefined;\n  protected _cacheActualTooltip: IToolTipActual | undefined;\n\n  protected _isTooltipPaused: boolean;\n  protected _isPointerEscaped: boolean;\n  protected _cachePointerTimer: number;\n  protected _cachePointerPosition: ILayoutPoint;\n  protected _cacheTooltipPosition: ILayoutPoint;\n  protected _cacheTooltipSize: IContainerSize;\n\n  // tooltip 容器\n  protected _container!: Maybe<IGroup | HTMLElement>;\n\n  protected _isReleased: boolean = false;\n\n  /**\n   * Create the tooltip handler.\n   */\n  constructor(tooltipId: string, component: Tooltip) {\n    this._component = component;\n    this._chartOption = component.getOption() as any;\n    this._env = this._chartOption.mode;\n    this._chartContainer = this._chartOption.globalInstance.getContainer();\n    this._compiler = component.getCompiler();\n    this._id = tooltipId; // 可能有多个 tooltip\n    this._initFromSpec();\n  }\n\n  showTooltip = (activeType: TooltipActiveType, data: TooltipData, params: TooltipHandlerParams) => {\n    let changePositionOnly = !!params.changePositionOnly;\n    if (!params.changePositionOnly || this._cacheActualTooltip?.activeType !== activeType) {\n      changePositionOnly = false;\n      this._clearCacheOfContent();\n    }\n\n    if (changePositionOnly && this._cacheViewSpec && this._cacheActualTooltip) {\n      return this.changeTooltipPosition(changePositionOnly, data, params);\n    }\n    return this.changeTooltip(true, params, changePositionOnly, activeType, data);\n  };\n\n  /** 改变 tooltip 内容和位置（带 throttle 版本），返回是否遇到异常 */\n  protected changeTooltip: ChangeTooltipFunc;\n\n  /** 改变 tooltip 内容和位置（不带 throttle 版本），返回是否遇到异常 */\n  protected _changeTooltip: ChangeTooltipFunc = (\n    visible: boolean,\n    params: TooltipHandlerParams,\n    changePositionOnly?: boolean,\n    activeType?: TooltipActiveType,\n    data?: TooltipData\n  ) => {\n    const tooltipSpec = this._component.getSpec() as ITooltipSpec;\n    if (this._isReleased || !tooltipSpec) {\n      return TooltipResult.failed;\n    }\n\n    /** 关闭 tooltip */\n    if (!visible) {\n      this._clearAllCache();\n\n      /** 用户自定义逻辑 */\n      if (tooltipSpec.handler) {\n        return tooltipSpec.handler.hideTooltip?.(params) ?? TooltipResult.success;\n      }\n      /** 默认逻辑 */\n      this._updateTooltip(false, params);\n      return TooltipResult.success;\n    }\n\n    if (isNil(activeType) || isNil(data)) {\n      return TooltipResult.failed;\n    }\n\n    /** spec 预处理 */\n    let spec: ITooltipSpec | undefined;\n    if (changePositionOnly && this._cacheViewSpec) {\n      spec = this._cacheViewSpec;\n    } else {\n      spec = getTooltipSpecForShow(\n        activeType!,\n        tooltipSpec,\n        (params as BaseEventParams).model as ISeries,\n        (params as DimensionEventParams).dimensionInfo\n      );\n      this._cacheViewSpec = spec;\n    }\n\n    if (spec.visible === false) {\n      return TooltipResult.failed;\n    }\n\n    /** 用户自定义逻辑 */\n    if (spec.handler) {\n      return spec.handler.showTooltip?.(activeType!, data!, params) ?? TooltipResult.success;\n    }\n\n    /** 默认逻辑 */\n    const pattern = spec[activeType!] as ITooltipPattern;\n    if (!pattern) {\n      return TooltipResult.failed;\n    }\n\n    // 合成 tooltip 内容\n    let actualTooltip: IToolTipActual | undefined;\n    if (changePositionOnly && this._cacheActualTooltip) {\n      actualTooltip = this._cacheActualTooltip;\n    } else {\n      actualTooltip = this._getActualTooltipContent(pattern, data!, params);\n      actualTooltip.title = pattern.updateTitle?.(actualTooltip.title, data, params) ?? actualTooltip.title;\n      actualTooltip.content = pattern.updateContent?.(actualTooltip.content, data, params) ?? actualTooltip.content;\n    }\n\n    // 判断 tooltip 是否为空\n    if (isNil(actualTooltip.title?.key) && isNil(actualTooltip.title?.value) && !actualTooltip.content?.length) {\n      return TooltipResult.failed;\n    }\n\n    this._cacheActualTooltip = actualTooltip;\n    return this._changeTooltipPosition(!!changePositionOnly, data!, params);\n  };\n\n  /** 改变 tooltip 位置（带 throttle 版本），返回是否遇到异常 */\n  protected changeTooltipPosition: ChangeTooltipPositionFunc;\n\n  /** 改变 tooltip 位置（不带 throttle 版本），返回是否遇到异常 */\n  protected _changeTooltipPosition: ChangeTooltipPositionFunc = (\n    changePositionOnly: boolean,\n    data: TooltipData,\n    params: TooltipHandlerParams\n  ) => {\n    if (this._isReleased) {\n      return TooltipResult.failed;\n    }\n\n    const event = params.event as MouseEvent;\n    const spec = this._cacheViewSpec;\n    const actualTooltip = this._cacheActualTooltip;\n    if (!spec || !actualTooltip) {\n      return TooltipResult.failed;\n    }\n\n    if (spec.enterable) {\n      if (!this._isPointerEscaped && this._isPointerMovingToTooltip(params)) {\n        if (!this._isTooltipPaused) {\n          this._isTooltipPaused = true;\n          this._cachePointerTimer = setTimeout(() => {\n            this._isPointerEscaped = true;\n          }, 300) as unknown as number;\n        }\n        return TooltipResult.success;\n      }\n      this._isTooltipPaused = false;\n      this._isPointerEscaped = false;\n      clearTimeout(this._cachePointerTimer);\n      this._cachePointerPosition = this._getPointerPositionRelativeToTooltipParent(params);\n    }\n\n    const activeType = actualTooltip.activeType;\n\n    /** 用户自定义逻辑 */\n    if (spec.handler) {\n      return spec.handler.showTooltip?.(activeType, data, params) ?? TooltipResult.success;\n    }\n\n    /** 默认逻辑 */\n    const pattern = spec[activeType];\n    if (!pattern) {\n      return TooltipResult.failed;\n    }\n\n    // 计算 tooltip 位置\n    const position = this._getActualTooltipPosition(\n      actualTooltip,\n      params,\n      this._getTooltipBoxSize(actualTooltip, changePositionOnly)\n    );\n    actualTooltip.position = position;\n    if (pattern.updatePosition) {\n      actualTooltip.position = pattern.updatePosition(actualTooltip.position, data, params);\n    }\n\n    // 判断 tooltip 可见性\n    let tooltipVisible = pattern?.visible !== false;\n    if (\n      !data ||\n      event.type === 'pointerout' ||\n      !actualTooltip.visible ||\n      (!actualTooltip.title && !actualTooltip.content)\n    ) {\n      tooltipVisible = false;\n    }\n\n    this._updateTooltip(\n      tooltipVisible,\n      {\n        ...params,\n        changePositionOnly\n      },\n      actualTooltip\n    );\n    return TooltipResult.success;\n  };\n\n  hideTooltip(params: TooltipHandlerParams): TooltipResult {\n    return this.changeTooltip(false, params);\n  }\n\n  release(): void {\n    this._clearAllCache();\n    const spec = this._component.getSpec() ?? {};\n    /** 用户自定义逻辑 */\n    if (spec.handler) {\n      spec.handler.release?.();\n      return;\n    }\n    /** 默认逻辑 */\n    this._removeTooltip();\n\n    this._isReleased = true;\n  }\n\n  protected _clearAllCache() {\n    this._clearCacheOfContent();\n    this._clearCacheOfPosition();\n  }\n\n  protected _clearCacheOfContent() {\n    this._cacheViewSpec = undefined;\n    this._cacheActualTooltip = undefined;\n  }\n\n  protected _clearCacheOfPosition() {\n    this._isTooltipPaused = false;\n    this._isPointerEscaped = false;\n    clearTimeout(this._cachePointerTimer);\n    this._cachePointerTimer = -1;\n    this._cachePointerPosition = undefined;\n    this._cacheTooltipPosition = undefined;\n    this._cacheTooltipSize = undefined;\n  }\n\n  /* -----需要子类继承的方法开始----- */\n\n  protected abstract _updateTooltip(visible: boolean, params: TooltipHandlerParams, domData?: IToolTipActual): void;\n  protected abstract _removeTooltip(): void;\n\n  /* -----需要子类继承的方法结束----- */\n\n  protected _throttle(callback: any) {\n    const tooltipSpec = this._component.getSpec();\n    let wait: number;\n    if (isNumber(tooltipSpec.throttleInterval)) {\n      wait = tooltipSpec.throttleInterval;\n    } else {\n      if (tooltipSpec.renderMode !== 'html' || !tooltipSpec.transitionDuration) {\n        wait = 10;\n      } else {\n        wait = 50;\n      }\n    }\n    return throttle(callback, wait);\n  }\n\n  protected _getDefaultOption(): Options {\n    const { offset } = this._component.getSpec();\n    return {\n      ...DEFAULT_OPTIONS,\n      offsetX: offset?.x ?? DEFAULT_OPTIONS.offsetX,\n      offsetY: offset?.y ?? DEFAULT_OPTIONS.offsetY\n    };\n  }\n\n  /**\n   * 计算实际的 tooltip 内容\n   * @param pattern\n   * @param data\n   * @param event\n   */\n  protected _getActualTooltipContent = (\n    pattern: ITooltipPattern,\n    data: TooltipData,\n    params: TooltipHandlerParams\n  ): IToolTipActual => {\n    // 可见性\n    const patternVisible = getTooltipPatternValue(pattern.visible, data, params);\n\n    // 数据\n    let tooltipContent: TooltipActualTitleContent | null = null;\n    tooltipContent = getShowContent(pattern, data, params);\n\n    const actualTooltip: IToolTipActual = {\n      ...tooltipContent,\n      visible: isValid(tooltipContent) ? patternVisible !== false : false, // 最终展示数据为 null 则不展示\n      activeType: pattern.activeType,\n      data\n    };\n\n    return actualTooltip;\n  };\n\n  /**\n   * 计算实际的 tooltip 位置\n   */\n  protected _getActualTooltipPosition = (\n    actualTooltip: IToolTipActual,\n    params: TooltipHandlerParams,\n    tooltipBoxSize: IContainerSize | undefined\n  ): ITooltipPositionActual => {\n    const event = params.event as MouseEvent;\n\n    const invalidPosition = {\n      x: Infinity,\n      y: Infinity\n    };\n\n    const { offsetX, offsetY } = this._option;\n    const tooltipSpec = this._cacheViewSpec;\n    if (!tooltipSpec) {\n      this._cacheTooltipPosition = undefined;\n      return invalidPosition;\n    }\n\n    const { activeType, data } = actualTooltip;\n    const pattern = tooltipSpec[activeType];\n    const position = getTooltipPatternValue(pattern.position, data, params);\n    const positionMode = getTooltipPatternValue(pattern.positionMode, data, params);\n    const tooltipParentElement = this._getParentElement(tooltipSpec);\n    const { width: tooltipBoxWidth = 0, height: tooltipBoxHeight = 0 } = tooltipBoxSize ?? {};\n\n    const isCanvas = tooltipSpec.renderMode === 'canvas';\n    const canvasRect = params?.chart?.getCanvasRect();\n    const canvasWidth = canvasRect?.width ?? DEFAULT_CHART_WIDTH;\n    const canvasHeight = canvasRect?.height ?? DEFAULT_CHART_HEIGHT;\n    let isFixedPosition = false;\n\n    const containerSize = {\n      width: 0,\n      height: 0\n    };\n    let relativePosOffset = { x: 0, y: 0 };\n    let tooltipParentElementRect: IPoint | DOMRect = { x: 0, y: 0 };\n    let chartElementScale = 1;\n    let tooltipParentElementScale = 1;\n\n    if (isTrueBrowser(this._env) && !tooltipSpec.confine) {\n      // 只有在 browser 模式下才可以获取到 window 对象\n      containerSize.width = window.innerWidth;\n      containerSize.height = window.innerHeight;\n\n      if (!isCanvas) {\n        tooltipParentElementRect = tooltipParentElement?.getBoundingClientRect() ?? invalidPosition;\n        const chartElement = (this._compiler.getCanvas() ?? this._chartContainer) as HTMLElement;\n        const chartElementRect = chartElement?.getBoundingClientRect();\n        relativePosOffset = {\n          x: chartElementRect.x - tooltipParentElementRect.x,\n          y: chartElementRect.y - tooltipParentElementRect.y\n        };\n        chartElementScale = getScale(chartElement, chartElementRect);\n        tooltipParentElementScale = getScale(tooltipParentElement, tooltipParentElementRect as DOMRect);\n      }\n    } else {\n      containerSize.width = canvasWidth;\n      containerSize.height = canvasHeight;\n    }\n    const tooltipSizeScale = tooltipParentElementScale / chartElementScale;\n\n    /* 一、计算 left、top、right、bottom */\n    let left: number | undefined;\n    let top: number | undefined;\n    let right: number | undefined;\n    let bottom: number | undefined;\n    if (isObject(position)) {\n      const { left: posLeft, right: posRight, top: posTop, bottom: posBottom } = position as ITooltipPositionPattern;\n      left = getActualTooltipPositionValue(posLeft, event);\n      top = getActualTooltipPositionValue(posTop, event);\n      right = getActualTooltipPositionValue(posRight, event);\n      bottom = getActualTooltipPositionValue(posBottom, event);\n    } else if (\n      isValid(position) &&\n      positionMode !== TooltipPositionMode.pointer &&\n      actualTooltip.activeType === 'mark'\n    ) {\n      isFixedPosition = true;\n      const element = params.item as IElement;\n      const model = params.model as IModel;\n      const bounds = element?.getBounds() as AABBBounds;\n      const startPoint = (<ILayoutModel>(<unknown>model))?.getLayoutStartPoint();\n      if (bounds && startPoint) {\n        let { x1, y1, x2, y2 } = bounds;\n        x1 += startPoint.x;\n        x2 += startPoint.x;\n        y1 += startPoint.y;\n        y2 += startPoint.y;\n        switch (getHorizontalPositionType(position)) {\n          case 'left':\n            left = x1 - tooltipBoxWidth * tooltipSizeScale - offsetX;\n            break;\n          case 'right':\n            left = x2 + offsetX;\n            break;\n          case 'middle':\n            left = (x1 + x2) / 2 - (tooltipBoxWidth * tooltipSizeScale) / 2;\n            break;\n        }\n        switch (getVerticalPositionType(position)) {\n          case 'top':\n            top = y1 - tooltipBoxHeight * tooltipSizeScale - offsetY;\n            break;\n          case 'bottom':\n            top = y2 + offsetY;\n            break;\n          case 'middle':\n            top = (y1 + y2) / 2 - (tooltipBoxHeight * tooltipSizeScale) / 2;\n            break;\n        }\n      }\n    }\n\n    /* 二、换算成 x 和 y */\n    let x: number;\n    let y: number;\n\n    const { canvasX, canvasY } = event as any;\n    if (isValidNumber(left)) {\n      x = left;\n    } else if (isValidNumber(right)) {\n      x = canvasWidth - tooltipBoxWidth * tooltipSizeScale - right;\n    } else {\n      const x0 = canvasX;\n      switch (getHorizontalPositionType(position as TooltipFixedPosition, 'right')) {\n        case 'middle':\n          x = x0 - (tooltipBoxWidth * tooltipSizeScale) / 2;\n          break;\n        case 'left':\n          x = x0 - tooltipBoxWidth * tooltipSizeScale - offsetX;\n          break;\n        case 'right':\n          x = x0 + offsetX;\n          break;\n      }\n    }\n    if (isValidNumber(top)) {\n      y = top;\n    } else if (isValidNumber(bottom)) {\n      y = canvasHeight - tooltipBoxHeight * tooltipSizeScale - bottom;\n    } else {\n      const y0 = canvasY;\n      switch (getVerticalPositionType(position as TooltipFixedPosition, 'bottom')) {\n        case 'middle':\n          y = y0 - (tooltipBoxHeight * tooltipSizeScale) / 2;\n          break;\n        case 'top':\n          y = y0 - tooltipBoxHeight * tooltipSizeScale - offsetY;\n          break;\n        case 'bottom':\n          y = y0 + offsetY;\n          break;\n      }\n    }\n\n    x *= chartElementScale;\n    y *= chartElementScale;\n    if (isTrueBrowser(this._env)) {\n      x += relativePosOffset.x;\n      y += relativePosOffset.y;\n    }\n    x /= tooltipParentElementScale;\n    y /= tooltipParentElementScale;\n\n    /* 三、确保tooltip在视区内 */\n    const { width: containerWidth, height: containerHeight } = containerSize;\n\n    const isLeftOut = () => x * tooltipParentElementScale + tooltipParentElementRect.x < 0;\n    const isRightOut = () =>\n      (x + tooltipBoxWidth) * tooltipParentElementScale + tooltipParentElementRect.x > containerWidth;\n    const isTopOut = () => y * tooltipParentElementScale + tooltipParentElementRect.y < 0;\n    const isBottomOut = () =>\n      (y + tooltipBoxHeight) * tooltipParentElementScale + tooltipParentElementRect.y > containerHeight;\n\n    const detectLeftFirst = () => {\n      if (isLeftOut()) {\n        // 位置不超出视区左界\n        if (isFixedPosition) {\n          x = -tooltipParentElementRect.x / tooltipParentElementScale;\n        } else {\n          if (getHorizontalPositionType(position as TooltipFixedPosition, 'right') === 'middle') {\n            x += offsetX + tooltipBoxWidth / 2;\n          } else {\n            x += offsetX * 2 + tooltipBoxWidth;\n          }\n        }\n      }\n    };\n    const detectLeftLast = () => {\n      if (isLeftOut()) {\n        // 位置不超出视区左界\n        x = -tooltipParentElementRect.x / tooltipParentElementScale;\n      }\n    };\n    const detectRightFirst = () => {\n      if (isRightOut()) {\n        // 位置不超出视区右界\n        if (isFixedPosition) {\n          x = (containerWidth - tooltipParentElementRect.x) / tooltipParentElementScale - tooltipBoxWidth;\n        } else {\n          if (getHorizontalPositionType(position as TooltipFixedPosition, 'right') === 'middle') {\n            x -= offsetX + tooltipBoxWidth / 2;\n          } else {\n            x -= offsetX * 2 + tooltipBoxWidth;\n          }\n        }\n      }\n    };\n    const detectRightLast = () => {\n      if (isRightOut()) {\n        // 位置不超出视区右界\n        x = (containerWidth - tooltipParentElementRect.x) / tooltipParentElementScale - tooltipBoxWidth;\n      }\n    };\n    const detectTopFirst = () => {\n      if (isTopOut()) {\n        // 位置不超出视区上界\n        if (isFixedPosition) {\n          y = -tooltipParentElementRect.y / tooltipParentElementScale;\n        } else {\n          if (getVerticalPositionType(position as TooltipFixedPosition, 'bottom') === 'middle') {\n            y += offsetY + tooltipBoxHeight / 2;\n          } else {\n            y += offsetY * 2 + tooltipBoxHeight;\n          }\n        }\n      }\n    };\n    const detectTopLast = () => {\n      if (isTopOut()) {\n        // 位置不超出视区上界\n        y = 0 - tooltipParentElementRect.y / tooltipParentElementScale;\n      }\n    };\n    const detectBottomFirst = () => {\n      if (isBottomOut()) {\n        // 位置不超出视区下界\n        if (isFixedPosition) {\n          y = (containerHeight - tooltipParentElementRect.y) / tooltipParentElementScale - tooltipBoxHeight;\n        } else {\n          if (getVerticalPositionType(position as TooltipFixedPosition, 'bottom') === 'middle') {\n            y -= offsetY + tooltipBoxHeight / 2;\n          } else {\n            y -= offsetY * 2 + tooltipBoxHeight;\n          }\n        }\n      }\n    };\n    const detectBottomLast = () => {\n      if (isBottomOut()) {\n        // 位置不超出视区下界\n        y = (containerHeight - tooltipParentElementRect.y) / tooltipParentElementScale - tooltipBoxHeight;\n      }\n    };\n\n    // 处理左右\n    switch (getHorizontalPositionType(position as TooltipFixedPosition, 'right')) {\n      case 'middle':\n        if (isLeftOut()) {\n          detectLeftFirst();\n          detectRightLast();\n        } else {\n          detectRightFirst();\n          detectLeftLast();\n        }\n        break;\n      case 'left':\n        detectLeftFirst();\n        detectRightLast();\n        break;\n      case 'right':\n        detectRightFirst();\n        detectLeftLast();\n        break;\n    }\n    // 处理上下\n    switch (getVerticalPositionType(position as TooltipFixedPosition, 'bottom')) {\n      case 'middle':\n        if (isTopOut()) {\n          detectTopFirst();\n          detectBottomLast();\n        } else {\n          detectBottomFirst();\n          detectTopLast();\n        }\n        break;\n      case 'top':\n        detectTopFirst();\n        detectBottomLast();\n        break;\n      case 'bottom':\n        detectBottomFirst();\n        detectTopLast();\n        break;\n    }\n\n    const result = { x, y };\n    this._cacheTooltipPosition = result;\n    this._cacheTooltipSize = { width: tooltipBoxWidth, height: tooltipBoxHeight };\n    return result;\n  };\n\n  // 计算 tooltip 内容区域的宽高，并缓存结果\n  protected _getTooltipBoxSize(actualTooltip: IToolTipActual, changePositionOnly: boolean): IContainerSize | undefined {\n    if (!changePositionOnly || isNil(this._attributes)) {\n      const chartTheme = this._chartOption?.getTheme() ?? {};\n      this._attributes = getTooltipAttributes(actualTooltip, this._component.getSpec(), chartTheme);\n    }\n    return {\n      width: this._attributes?.panel?.width,\n      height: this._attributes?.panel?.height\n    };\n  }\n\n  protected _getPointerPositionRelativeToTooltipParent(params: TooltipHandlerParams) {\n    let { canvasX: x, canvasY: y } = params.event;\n\n    const invalidPosition = {\n      x: Infinity,\n      y: Infinity\n    };\n\n    const tooltipSpec = this._cacheViewSpec;\n    const isCanvas = tooltipSpec.renderMode === 'canvas';\n    const tooltipParentElement = this._getParentElement(tooltipSpec);\n\n    let relativePosOffset = { x: 0, y: 0 };\n    let tooltipParentElementRect: IPoint | DOMRect = { x: 0, y: 0 };\n    let chartElementScale = 1;\n    let tooltipParentElementScale = 1;\n\n    if (isTrueBrowser(this._env) && !tooltipSpec.confine) {\n      if (!isCanvas) {\n        tooltipParentElementRect = tooltipParentElement?.getBoundingClientRect() ?? invalidPosition;\n        const chartElement = (this._compiler.getCanvas() ?? this._chartContainer) as HTMLElement;\n        const chartElementRect = chartElement?.getBoundingClientRect();\n        relativePosOffset = {\n          x: chartElementRect.x - tooltipParentElementRect.x,\n          y: chartElementRect.y - tooltipParentElementRect.y\n        };\n        chartElementScale = getScale(chartElement, chartElementRect);\n        tooltipParentElementScale = getScale(tooltipParentElement, tooltipParentElementRect as DOMRect);\n      }\n    }\n\n    x *= chartElementScale;\n    y *= chartElementScale;\n    if (isTrueBrowser(this._env)) {\n      x += relativePosOffset.x;\n      y += relativePosOffset.y;\n    }\n    x /= tooltipParentElementScale;\n    y /= tooltipParentElementScale;\n    return { x, y };\n  }\n\n  protected _isPointerMovingToTooltip(params: TooltipHandlerParams) {\n    if (!this._cacheTooltipPosition || !this._cacheTooltipSize || !this._cachePointerPosition) {\n      return false;\n    }\n    const { width: tooltipWidth, height: tooltipHeight } = this._cacheTooltipSize;\n    const { x: tooltipX = 0, y: tooltipY } = this._cacheTooltipPosition;\n\n    const pos = this._getPointerPositionRelativeToTooltipParent(params);\n\n    if (\n      pointInRect(\n        pos,\n        {\n          x1: tooltipX,\n          y1: tooltipY,\n          x2: tooltipX + tooltipWidth,\n          y2: tooltipY + tooltipHeight\n        },\n        false\n      )\n    ) {\n      return true;\n    }\n\n    // 确定 tooltip 四端点坐标\n    const a = { x: tooltipX, y: tooltipY };\n    const b = { x: a.x + tooltipWidth, y: a.y };\n    const c = { x: a.x, y: a.y + tooltipHeight };\n    const d = { x: b.x, y: c.y };\n    const oldPos = this._cachePointerPosition;\n\n    return (\n      polygonContainPoint([oldPos, a, b], pos.x, pos.y) ||\n      polygonContainPoint([oldPos, c, d], pos.x, pos.y) ||\n      polygonContainPoint([oldPos, a, d], pos.x, pos.y) ||\n      polygonContainPoint([oldPos, b, c], pos.x, pos.y)\n    );\n  }\n\n  protected _getParentElement(spec: ITooltipSpec): HTMLElement {\n    return spec.parentElement as any;\n  }\n\n  getTooltipContainer() {\n    return this._container;\n  }\n\n  protected _initFromSpec() {\n    this._option = this._getDefaultOption();\n    // 为方法加防抖\n    this.changeTooltip = this._throttle(this._changeTooltip) as any;\n    this.changeTooltipPosition = this._throttle(this._changeTooltipPosition) as any;\n  }\n\n  reInit() {\n    this._initFromSpec();\n  }\n}\n"]}