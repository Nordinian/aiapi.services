import { getTextBounds } from "@visactor/vrender-core";

import { TextMeasure } from "@visactor/vutils";

import { DEFAULT_TEXT_FONT_FAMILY, DEFAULT_TEXT_FONT_SIZE } from "../constant";

export const initTextMeasure = (textSpec, option, useNaiveCanvas) => new TextMeasure(Object.assign({
    defaultFontParams: {
        fontFamily: DEFAULT_TEXT_FONT_FAMILY,
        fontSize: DEFAULT_TEXT_FONT_SIZE
    },
    getTextBounds: useNaiveCanvas ? void 0 : getTextBounds,
    specialCharSet: "-/: .,@%'\"~" + TextMeasure.ALPHABET_CHAR_SET + TextMeasure.ALPHABET_CHAR_SET.toUpperCase()
}, null != option ? option : {}), textSpec);

export function measureTextSize(text, textSpec, fontFamily = DEFAULT_TEXT_FONT_FAMILY) {
    var _a, _b;
    if (!text) return {
        width: 0,
        height: 0
    };
    const bounds = getTextBounds({
        text: text,
        fontFamily: null !== (_a = textSpec.fontFamily) && void 0 !== _a ? _a : fontFamily,
        fontSize: textSpec.fontSize || 12,
        fontWeight: textSpec.fontWeight,
        textAlign: null !== (_b = textSpec.textAlign) && void 0 !== _b ? _b : "center",
        textBaseline: textSpec.textBaseline,
        ellipsis: !!textSpec.ellipsis,
        maxLineWidth: textSpec.maxLineWidth || 1 / 0,
        lineHeight: textSpec.fontSize || 12
    });
    return {
        width: bounds.width(),
        height: bounds.height()
    };
}
//# sourceMappingURL=text.js.map
