{"version":3,"sources":["../src/label/type.ts"],"names":[],"mappings":"","file":"type.js","sourcesContent":["import type {\n  EasingType,\n  IGraphic,\n  IGroupGraphicAttribute,\n  ITextGraphicAttribute,\n  IRichTextGraphicAttribute,\n  IText,\n  TextAlignType,\n  TextBaselineType,\n  ILineGraphicAttribute,\n  IRichTextCharacter,\n  IRichText,\n  ILine\n} from '@visactor/vrender-core';\nimport type { IPointLike } from '@visactor/vutils';\n\nexport type LabelItemStateStyle<T> = {\n  hover?: T;\n  hover_reverse?: T;\n  selected?: T;\n  selected_reverse?: T;\n  [key: string]: T;\n};\n\nexport type LabelItem = {\n  // 用于动画\n  id?: string;\n  // 原始数据\n  data?: any;\n  [key: string]: any;\n  // 文本类型：text, rich, html (区分于图元类型)\n  textType?: string;\n  /**\n   * 文本内容，如果需要进行换行，则使用数组形式，如 ['abc', '123']\n   * 支持富文本内容, 如textConfig, html\n   */\n  text?: string | string[] | number | number[] | IRichTextCharacter[];\n  /**\n   * 兼容ITextGraphicAttribute与IRichTextGraphicAttribute的textAlign属性\n   */\n  textAlign?: 'left' | 'right' | 'center' | 'start' | 'end';\n  textBaseline?: 'top' | 'middle' | 'bottom' | 'alphabetic';\n} & Omit<Partial<ITextGraphicAttribute>, 'textAlign' | 'textBaseline'> &\n  Omit<Partial<IRichTextGraphicAttribute>, 'textAlign' | 'textBaseline'>;\n\nexport interface BaseLabelAttrs extends IGroupGraphicAttribute {\n  type: string;\n  /**\n   *  图元 group 名称\n   */\n  baseMarkGroupName: string;\n  /**\n   * @hack not recommend to use\n   * @returns\n   */\n  getBaseMarks?: () => IGraphic[];\n  /**\n   * 是否开启选中交互\n   * @default false\n   */\n  select?: boolean;\n  /**\n   * 是否开启 hover 交互\n   * @default false\n   */\n  hover?: boolean;\n  /**\n   * 标签数据\n   */\n  data: LabelItem[];\n\n  /** 文本样式，优先级低于 data */\n  textStyle?: Partial<ITextGraphicAttribute>;\n\n  /** 文本交互样式 */\n  state?: LabelItemStateStyle<ITextGraphicAttribute>;\n\n  /** 连接线样式 */\n  line?: ILabelLineSpec;\n\n  /** 连线的交互样式 */\n  labelLineState?: LabelItemStateStyle<ILineGraphicAttribute>;\n\n  syncState?: boolean;\n\n  /** 标签默认位置 */\n  position?: Functional<string>;\n\n  /** 偏移量 */\n  offset?: number;\n\n  /** 是否开启防重叠\n   * @default true\n   */\n  overlap?: OverlapAttrs | boolean;\n\n  /** 智能反色 */\n  smartInvert?: SmartInvertAttrs | boolean;\n\n  /** 动画配置 */\n  animation?: ILabelAnimation | boolean;\n  animationEnter?: ILabelUpdateAnimation;\n  animationUpdate?: ILabelUpdateAnimation | ILabelUpdateChannelAnimation[];\n  animationExit?: ILabelExitAnimation;\n\n  // 排序 or 删减\n  dataFilter?: (data: LabelItem[]) => LabelItem[];\n\n  /** 自定义布局函数\n   * @description 当配置了 customLayoutFunc 后，默认布局逻辑将不再生效。（position/offset不生效）\n   */\n  customLayoutFunc?: (\n    data: LabelItem[],\n    getRelatedGraphic: (data: LabelItem) => IGraphic,\n    getRelatedPoint?: (data: LabelItem) => IPointLike\n  ) => (IText | IRichText)[];\n\n  /** 自定义标签躲避函数\n   * @description 当配置了 customOverlapFunc 后，会根据 position 和 offset 进行初始布局。配置的防重叠逻辑(overlap)不生效。\n   */\n  customOverlapFunc?: (\n    label: (IText | IRichText)[],\n    getRelatedGraphic: (data: LabelItem) => IGraphic,\n    getRelatedPoint?: (data: LabelItem) => IPointLike\n  ) => (IText | IRichText)[];\n  /**\n   * 关闭交互效果\n   * @default false\n   */\n  disableTriggerEvent?: boolean;\n  /** 唯一标志符 */\n  id?: string;\n}\n\nexport interface OverlapAttrs {\n  /**\n   * 防重叠的区域大小\n   */\n  size?: { width: number; height: number };\n\n  /**\n   * 发生重叠后，是否隐藏标签\n   * @default true\n   */\n  hideOnHit?: boolean;\n\n  /**\n   * 是否约束标签在指定 size 的范围内。开启后若标签被区域裁剪，会向内收缩。\n   * @default true\n   */\n  clampForce?: boolean;\n\n  /**\n   * 是否躲避基础图元\n   * @default false\n   */\n  avoidBaseMark?: boolean;\n\n  /**\n   * 躲避指定图元\n   * @default []\n   */\n  avoidMarks?: string[] | IGraphic[];\n\n  /**\n   * 发生重叠后的躲避策略\n   */\n  strategy?: Strategy[];\n\n  /**\n   * 文字在防重叠计算中预留的边距。\n   * @default 0\n   */\n  overlapPadding?: number;\n}\n\nexport interface SmartInvertAttrs {\n  /**\n   * 对比度度量\n   * 'WCAG' | 'lightness'\n   * 默认使用'WCAG'\n   */\n  mode?: string;\n  /**\n   * 文本类型\n   * 包含普通文本和大文本，对应不同的对比度标准，label默认为普通文本\n   * 'normalText' ｜ 'largeText'\n   * @default 'normalText'\n   */\n  textType?: string;\n  /**\n   * 自定义对比度阈值\n   */\n  contrastRatiosThreshold?: number;\n  /**\n   * 自定义备选label颜色\n   */\n  alternativeColors?: string | string[];\n  /**\n   * fillStrategy四种策略：\n   * - base（baseMark色），\n   * - invertBase（执行智能反色），\n   * - similarBase（智能反色的补色），\n   * - null（不执行智能反色，保持fill设置的颜色）\n   * @default 'invertBase'\n   */\n  fillStrategy?: 'base' | 'invertBase' | 'similarBase' | 'null';\n  /**\n   * strokeStrategy的四种策略:\n   * - base（baseMark色），\n   * - invertBase（执行智能反色），\n   * - similarBase（智能反色的补色），\n   * - null（不执行智能反色，保持stroke设置的颜色）\n   * @default 'base'\n   */\n  strokeStrategy?: 'base' | 'invertBase' | 'similarBase' | 'null';\n  /**\n   * 前景色与亮色具有对比度时，similarSeries使用该色\n   * @default '#ffffff'\n   */\n  brightColor?: string;\n  /**\n   * 前景色与暗色具有对比度时，similarSeries使用该色\n   * @default '#000000'\n   */\n  darkColor?: string;\n  /**\n   * label超出mark范围，也以mark作为背景色进行反色\n   */\n  outsideEnable?: boolean;\n}\n\nexport type PositionStrategy = {\n  /**\n   * 可选位置策略。\n   * 若默认位置没有足够的空间放置标签，则考虑 position 内的备选位置。\n   */\n  type: 'position';\n  position?: Functional<LabelPosition[]>;\n};\n\nexport type BoundStrategy = {\n  /**\n   * 标签配置在图形内部时使用。\n   * 当图形大小不足以放下标签，则考虑 position 内的备选位置。\n   */\n  type: 'bound';\n  position?: Functional<LabelPosition[]>;\n};\n\nexport type MoveYStrategy = {\n  /**\n   * 可选位置策略。\n   * 若默认位置没有足够的空间放置标签，则根据 offset 在Y方向上寻找位置。\n   */\n  type: 'moveY';\n  /**\n   * Y方向上的尝试的位置偏移量\n   */\n  offset: Functional<number[]>;\n};\n\nexport type MoveXStrategy = {\n  /**\n   * 可选位置策略。\n   * 若默认位置没有足够的空间放置标签，则根据 offset 在X方向上寻找位置。\n   */\n  type: 'moveX';\n  /**\n   * X方向上的尝试的位置偏移量\n   */\n  offset: Functional<number[]>;\n};\n\nexport type Strategy = PositionStrategy | BoundStrategy | MoveYStrategy | MoveXStrategy;\n\nexport type LabelPosition = SymbolLabelAttrs['position'] | RectLabelAttrs['position'];\n\nexport interface SymbolLabelAttrs extends BaseLabelAttrs {\n  type: 'symbol';\n\n  /**\n   * 标签位置\n   * @default 'top'\n   */\n  position?: Functional<\n    'top' | 'bottom' | 'left' | 'right' | 'top-right' | 'top-left' | 'bottom-right' | 'bottom-left' | 'center'\n  >;\n}\n\nexport interface RectLabelAttrs extends BaseLabelAttrs {\n  type: 'rect';\n  /**\n   * 标签位置\n   * @default 'top'\n   */\n  position?: Functional<\n    | 'top'\n    | 'bottom'\n    | 'left'\n    | 'right'\n    | 'inside'\n    | 'inside-top'\n    | 'inside-bottom'\n    | 'inside-right'\n    | 'inside-left'\n    | 'top-right'\n    | 'top-left'\n    | 'bottom-right'\n    | 'bottom-left'\n  >;\n}\n\nexport interface LineLabelAttrs extends BaseLabelAttrs {\n  type: 'line';\n  /**\n   * 标签位置\n   * @default 'end'\n   */\n  position?: Functional<'start' | 'end'>;\n}\n\nexport interface AreaLabelAttrs extends BaseLabelAttrs {\n  type: 'area';\n  /**\n   * 标签位置\n   * @default 'end'\n   */\n  position?: Functional<'start' | 'end'>;\n}\n\nexport interface LineDataLabelAttrs extends BaseLabelAttrs {\n  type: 'line-data';\n\n  /**\n   * 标签位置\n   * @default 'top'\n   */\n  position?: Functional<\n    'top' | 'bottom' | 'left' | 'right' | 'top-right' | 'top-left' | 'bottom-right' | 'bottom-left' | 'center'\n  >;\n}\n\nexport interface PolygonLabelAttrs extends BaseLabelAttrs {\n  type: 'polygon';\n  /**\n   * 标签位置\n   * @default 'center'\n   */\n  position?: Functional<'center'>;\n}\n\nexport interface ArcLabelAttrs extends BaseLabelAttrs {\n  type: 'arc';\n\n  /**\n   *  图元 group 名称\n   */\n  baseMarkGroupName: string;\n\n  /**\n   * 标签位置\n   * @default 'outside'\n   */\n  position?: Functional<'inside' | 'outside' | 'inside-inner' | 'inside-outer'>;\n\n  // 画布宽度\n  width?: number;\n  // 画布高度\n  height?: number;\n\n  /**\n   * 是否允许标签重叠\n   * @default false\n   */\n  coverEnable?: boolean;\n  /**\n   * 是否允许标签旋转\n   * @default true\n   */\n  rotate?: boolean;\n\n  /**\n   * 文字与引导线间隔宽度\n   * @default 5\n   */\n  spaceWidth?: number;\n  /**\n   * 标签旋转角度\n   */\n  angle?: number;\n  /**\n   * 标签旋转角度的偏移角度\n   */\n  offsetAngle?: number;\n  /**\n   * 标签相对于 `outerRadius` 的径向偏移，目前仅作用于 inside 标签\n   */\n  offsetRadius?: number;\n  /**\n   * 标签横向点对齐\n   */\n  textAlign?: TextAlignType;\n  /**\n   * 标签纵向点对齐\n   */\n  textBaseline?: TextBaselineType;\n  /**\n   * 扇区间标签的间隔\n   * @default 6\n   */\n  layoutArcGap?: number;\n  /** 标签引导线样式 */\n  line?: IArcLabelLineSpec;\n  /** 标签布局配置 */\n  layout?: IArcLabelLayoutSpec;\n  /** 标签引导线点集 */\n  points?: IPoint[];\n  /** 饼图扇区中心偏移 */\n  centerOffset?: number;\n}\n\nexport interface ILabelLineSpec {\n  /**\n   * 是否显示引导线\n   * @default true\n   */\n  visible?: boolean;\n  /**\n   * 引导线样式\n   */\n  style?: Partial<ILineGraphicAttribute>;\n}\n\nexport interface IArcLabelLineSpec extends ILabelLineSpec {\n  /**\n   * 引导线 line1 部分最小长度\n   * @default 20\n   */\n  line1MinLength?: number;\n  /**\n   * 引导线 line2 部分最小长度\n   * @default 10\n   */\n  line2MinLength?: number;\n  /**\n   * 引导线是否光滑\n   * @default false\n   */\n  smooth?: boolean;\n}\n\nexport type ArcLabelAlignType = 'arc' | 'labelLine' | 'edge';\n\nexport type ArcLabelStrategyType = 'priority' | 'vertical' | 'none';\n\nexport interface IArcLabelLayoutSpec {\n  /**\n   * 标签对齐方式\n   * @default 'arc'\n   */\n  textAlign?: ArcLabelAlignType;\n  /** @deprecate 建议统一使用textAlign，后续将废除 */\n  align?: ArcLabelAlignType;\n  /**\n   * 标签布局策略\n   * @default 'priority'\n   */\n  strategy?: ArcLabelStrategyType;\n  /**\n   * 是否启用切线约束\n   * @default true\n   */\n  tangentConstraint?: boolean;\n}\n\nexport interface DataLabelAttrs extends IGroupGraphicAttribute {\n  dataLabels: (RectLabelAttrs | SymbolLabelAttrs | ArcLabelAttrs | LineDataLabelAttrs)[];\n  /**\n   * 防重叠的区域大小\n   */\n  size: { width: number; height: number };\n}\n\nexport type Functional<T> = T | ((data: any) => T);\n\nexport interface ILabelExitAnimation {\n  duration?: number;\n  delay?: number;\n  easing?: EasingType;\n}\n\nexport interface ILabelEnterAnimation extends ILabelExitAnimation {\n  mode?: 'same-time' | 'after' | 'after-all';\n}\n\nexport interface ILabelUpdateAnimation extends ILabelExitAnimation {\n  /** 是否开启 increaseCount 动画\n   * @default true\n   */\n  increaseEffect?: boolean;\n}\n\nexport interface ILabelUpdateChannelAnimation extends ILabelUpdateAnimation {\n  channel?: string[];\n  options?: { excludeChannels?: string[] };\n}\n\nexport interface ILabelAnimation extends ILabelEnterAnimation, ILabelExitAnimation, ILabelUpdateAnimation {}\n\nexport interface IPoint {\n  x: number;\n  y: number;\n}\n\nexport interface IPolarPoint {\n  radius: number;\n  angle: number;\n}\n\nexport type Quadrant = 1 | 2 | 3 | 4;\n\nexport type TextAlign = 'left' | 'right' | 'center';\n\nexport type LabelContent = {\n  text: IText | IRichText;\n  labelLine?: ILine;\n};\n"]}