{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"AAEA,OAAO,MAAM,MAAM,kBAAkB,CAAC;AAEtC,OAAO,EAAE,iBAAiB,EAAE,cAAc,EAAE,gBAAgB,EAAE,kBAAkB,EAAE,MAAM,QAAQ,CAAC;AACjG,OAAO,EAAE,uBAAuB,EAAE,MAAM,aAAa,CAAC;AACtD,OAAO,EAAE,oBAAoB,EAAE,MAAM,oBAAoB,CAAC;AAE1D,cAAc,aAAa,CAAC;AAC5B,cAAc,aAAa,CAAC;AAC5B,cAAc,SAAS,CAAC;AACxB,cAAc,QAAQ,CAAC;AAEvB,MAAM,CAAC,MAAM,mBAAmB,GAAG,CAAC,OAAoC,EAAE,EAAE;IAC1E,MAAM,EAAE,WAAW,EAAE,cAAc,GAAG,IAAI,EAAE,qBAAqB,GAAG,KAAK,EAAE,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,EAAE,CAAC;IAE5F,qBAAqB,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;IAE1C,IAAI,cAAc,EAAE;QAClB,gBAAgB,CAAC,QAAQ,CAAC,IAAI,EAAE,oBAAoB,EAAE,GAAG,EAAE,CAAC,qBAAqB,EAAE,CAAC,CAAC;KACtF;IACD,IAAI,qBAAqB,EAAE;QACzB,kBAAkB,CAAC,GAAG,EAAE;YACtB,MAAM,IAAI,GAAG,cAAc,EAAE,CAAC;YAC9B,MAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC,WAAW,CAAC,CAAC;YAEnF,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,MAAM,KAAK,GAAG,WAAW,CAAC,GAAG,EAAE;gBAC7B,MAAM,KAAK,GAAG,uBAAuB,CAAC,IAAI,CAAC,CAAC;gBAC5C,IAAI,KAAK,GAAG,EAAE,IAAI,gBAAgB,KAAK,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,WAAW,CAAC,EAAE;oBACxE,qBAAqB,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;oBACzC,aAAa,CAAC,KAAK,CAAC,CAAC;iBACtB;gBACD,KAAK,EAAE,CAAC;YACV,CAAC,EAAE,GAAG,CAAC,CAAC;QACV,CAAC,CAAC,CAAC;KACJ;AACH,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,KAAe,EAAE,IAAuB,EAAE,KAAc,EAAE,EAAE;IAChG,IAAI,CAAC,IAAI,EAAE;QACT,IAAI,GAAG,cAAc,EAAE,CAAC;KACzB;IACD,MAAM,SAAS,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC;IAC1C,IAAI,CAAC,KAAK,IAAI,MAAM,CAAC,YAAY,CAAC,eAAe,EAAE,KAAK,SAAS,EAAE;QACjE,OAAO;KACR;SAAM,IAAI,KAAK,EAAE;QAChB,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;KAC5C;IACD,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE;QAC9C,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,SAAS,EAAE,KAAK,aAAL,KAAK,cAAL,KAAK,GAAI,uBAAuB,CAAC,IAAI,CAAC,CAAC,CAAC;KACtF;IACD,MAAM,CAAC,YAAY,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;AACjD,CAAC,CAAC","file":"index.js","sourcesContent":["import type { ITheme } from '@visactor/vchart';\n// eslint-disable-next-line no-duplicate-imports\nimport VChart from '@visactor/vchart';\nimport type { IInitVChartSemiThemeOption } from './interface';\nimport { generateThemeName, getCurrentMode, observeAttribute, observeThemeSwitch } from './util';\nimport { generateVChartSemiTheme } from './generator';\nimport { THEME_MODE_ATTRIBUTE } from './common/constants';\n\nexport * from './theme-map';\nexport * from './generator';\nexport * from './light';\nexport * from './dark';\n\nexport const initVChartSemiTheme = (options?: IInitVChartSemiThemeOption) => {\n  const { defaultMode, isWatchingMode = true, isWatchingThemeSwitch = false } = options ?? {};\n\n  switchVChartSemiTheme(false, defaultMode);\n\n  if (isWatchingMode) {\n    observeAttribute(document.body, THEME_MODE_ATTRIBUTE, () => switchVChartSemiTheme());\n  }\n  if (isWatchingThemeSwitch) {\n    observeThemeSwitch(() => {\n      const mode = getCurrentMode();\n      const cacheColorScheme = JSON.stringify(generateVChartSemiTheme(mode).colorScheme);\n      // 轮询直到监测到主题变化\n      let times = 0;\n      const timer = setInterval(() => {\n        const theme = generateVChartSemiTheme(mode);\n        if (times > 50 || cacheColorScheme !== JSON.stringify(theme.colorScheme)) {\n          switchVChartSemiTheme(true, mode, theme);\n          clearInterval(timer);\n        }\n        times++;\n      }, 100);\n    });\n  }\n};\n\nexport const switchVChartSemiTheme = (force?: boolean, mode?: 'light' | 'dark', theme?: ITheme) => {\n  if (!mode) {\n    mode = getCurrentMode();\n  }\n  const themeName = generateThemeName(mode);\n  if (!force && VChart.ThemeManager.getCurrentTheme() === themeName) {\n    return;\n  } else if (force) {\n    VChart.ThemeManager.removeTheme(themeName);\n  }\n  if (!VChart.ThemeManager.themeExist(themeName)) {\n    VChart.ThemeManager.registerTheme(themeName, theme ?? generateVChartSemiTheme(mode));\n  }\n  VChart.ThemeManager.setCurrentTheme(themeName);\n};\n"]}