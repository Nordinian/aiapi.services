{"version":3,"sources":["../src/core/vchart.ts"],"names":[],"mappings":"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","file":"vchart.js","sourcesContent":["import type { ISeries } from '../series/interface/series';\nimport { arrayParser } from '../data/parser/array';\nimport type { ILayoutConstructor, LayoutCallBack } from '../layout/interface';\nimport type { IDataValues, IMarkStateSpec, IInitOption } from '../typings/spec/common';\n// eslint-disable-next-line no-duplicate-imports\nimport { RenderModeEnum } from '../typings/spec/common';\nimport type { ISeriesConstructor } from '../series/interface';\nimport type {\n  DimensionIndexOption,\n  IChart,\n  IChartConstructor,\n  IChartSpecInfo,\n  IChartSpecTransformer\n} from '../chart/interface';\nimport type { IComponentConstructor } from '../component/interface';\n// eslint-disable-next-line no-duplicate-imports\nimport { ComponentTypeEnum } from '../component/interface/type';\nimport type {\n  EventCallback,\n  EventParams,\n  EventParamsDefinition,\n  EventQuery,\n  EventType,\n  IEvent,\n  IEventDispatcher\n} from '../event/interface';\nimport type { IParserOptions } from '@visactor/vdataset/es/parser';\nimport type { IFields, Transform } from '@visactor/vdataset';\n// eslint-disable-next-line no-duplicate-imports\nimport { DataSet, dataViewParser, DataView } from '@visactor/vdataset';\nimport type { Stage } from '@visactor/vrender-core';\nimport { isString, isValid, isNil, array, debounce, functionTransform } from '../util';\nimport { createID } from '../util/id';\nimport { convertPoint } from '../util/space';\nimport { isTrueBrowser } from '../util/env';\nimport { warn } from '../util/debug';\nimport { mergeSpec, mergeSpecWithFilter } from '../util/spec/merge-spec';\nimport { specTransform } from '../util/spec/transform';\nimport { getThemeObject } from '../util/spec/common';\nimport { Factory } from './factory';\nimport { Event } from '../event/event';\nimport { EventDispatcher } from '../event/event-dispatcher';\nimport type { GeoSourceType } from '../typings/geo';\nimport type { GeoSourceOption } from '../series/map/geo-source';\n// eslint-disable-next-line no-duplicate-imports\nimport { getMapSource } from '../series/map/geo-source';\n// eslint-disable-next-line no-duplicate-imports\nimport type { IMark, MarkConstructor } from '../mark/interface';\nimport { registerDataSetInstanceParser, registerDataSetInstanceTransform } from '../data/register';\nimport { dataToDataView } from '../data/initialize';\nimport { stackSplit } from '../data/transforms/stack-split';\nimport { copyDataView } from '../data/transforms/copy-data-view';\nimport type { ITooltipHandler } from '../typings/tooltip';\nimport type { Tooltip } from '../component/tooltip';\nimport type {\n  Datum,\n  IPoint,\n  IRegionQuerier,\n  IShowTooltipOption,\n  ISpec,\n  Maybe,\n  MaybeArray,\n  StringOrNumber\n} from '../typings';\nimport { AnimationStateEnum } from '../animation/interface';\nimport type { IBoundsLike, ILogger } from '@visactor/vutils';\nimport { ThemeManager } from '../theme/theme-manager';\nimport type { ITheme } from '../theme';\nimport type { IModel, IUpdateSpecResult } from '../model/interface';\nimport { Compiler } from '../compile/compiler';\nimport type { IMorphConfig } from '../animation/spec';\nimport type { ILegend } from '../component/legend/interface';\nimport { getCanvasDataURL, URLToImage } from '../util/image';\nimport { ChartEvent, DEFAULT_CHART_HEIGHT, DEFAULT_CHART_WIDTH, VGRAMMAR_HOOK_EVENT } from '../constant';\n// eslint-disable-next-line no-duplicate-imports\nimport {\n  getContainerSize,\n  isArray,\n  isEmpty,\n  Logger,\n  merge as mergeOrigin,\n  isFunction,\n  LoggerLevel,\n  isEqual,\n  get,\n  cloneDeep\n} from '@visactor/vutils';\nimport type {\n  DataLinkAxis,\n  DataLinkSeries,\n  IGlobalConfig,\n  IVChart,\n  IVChartRenderOption,\n  VChartRenderActionSource\n} from './interface';\nimport { InstanceManager } from './instance-manager';\nimport type { IAxis } from '../component/axis';\nimport { setPoptipTheme } from '@visactor/vrender-components';\nimport { calculateChartSize, mergeUpdateResult } from '../chart/util';\nimport { Region } from '../region/region';\nimport { Layout } from '../layout/base-layout';\nimport { registerGroupMark } from '../mark/group';\nimport { registerVGrammarCommonAnimation } from '../animation/config';\nimport { View, registerFilterTransform, registerMapTransform } from '@visactor/vgrammar-core';\nimport { VCHART_UTILS } from './util';\nimport { ExpressionFunction } from './expression-function';\nimport { registerBrowserEnv, registerNodeEnv } from '../env';\nimport { mergeTheme, preprocessTheme } from '../util/spec';\nimport { darkTheme, registerTheme } from '../theme/builtin';\nimport type { IChartPluginService } from '../plugin/chart/interface';\nimport { ChartPluginService } from '../plugin/chart/plugin-service';\n\nexport class VChart implements IVChart {\n  readonly id = createID();\n\n  /**\n   *  按需注册图表和组件\n   * @param comps\n   * @since 1.5.1\n   */\n  static useRegisters(comps: (() => void)[]) {\n    comps.forEach((fn: () => void) => {\n      if (typeof fn === 'function') {\n        // 确保元素是函数类型\n        fn();\n      } else {\n        console.error('Invalid function:', fn);\n      }\n    });\n  }\n\n  /**\n   * 注册自定义图表\n   * @param charts 图表类\n   * @description 若用于按需加载，1.5.1版本后，请统一使用 `useRegisters` API，例如:`VChart.useRegisters([registerLineChart])`。\n   */\n  static useChart(charts: IChartConstructor[]) {\n    charts.forEach(c => Factory.registerChart(c.type, c));\n  }\n  /**\n   * 注册自定义系列\n   * @param series 系列类\n   * @description  若用于按需加载，1.5.1版本后，统一使用 `useRegisters` API，例如 `VChart.useRegisters([registerLineSeries])`。\n   */\n  static useSeries(series: ISeriesConstructor[]) {\n    series.forEach(s => Factory.registerSeries(s.type, s));\n  }\n  /**\n   * 注册自定义组件\n   * @param components 组件类\n   * @description 若用于按需加载，1.5.1版本后，统一使用 `useRegisters` API，例如 `VChart.useRegisters([registerCartesianLinearAxis])`。\n   */\n  static useComponent(components: IComponentConstructor[]) {\n    components.forEach(c => Factory.registerComponent(c.type, c));\n  }\n  /**\n   * 注册自定义 Mark\n   * @param marks Mark 图元类\n   */\n  static useMark(marks: MarkConstructor[]) {\n    marks.forEach(m => Factory.registerMark(m.constructorType ?? m.type, m));\n  }\n  /**\n   * 注册自定义布局\n   * @param layouts 布局类\n   */\n  static useLayout(layouts: ILayoutConstructor[]) {\n    layouts.forEach(l => Factory.registerLayout(l.type, l));\n  }\n  /**\n   * 注册 DataSet 数据方法\n   * @param name 数据 transform 方法名称\n   * @param transform 具体的 Transform 执行方法\n   */\n  static registerDataSetTransform(name: string, transform: Transform) {\n    Factory.registerTransform(name, transform);\n  }\n\n  /**\n   * 注册函数（全局注册）\n   * @param key 函数名称\n   * @param fun 函数内容\n   */\n  static registerFunction(key: string, fun: Function) {\n    if (!key || !fun) {\n      return;\n    }\n    ExpressionFunction.instance().registerFunction(key, fun);\n  }\n\n  /**\n   * 注销函数（全局注销）\n   * @param key 函数名称\n   */\n  static unregisterFunction(key: string) {\n    if (!key) {\n      return;\n    }\n    ExpressionFunction.instance().unregisterFunction(key);\n  }\n\n  /**\n   * 获取函数（全局）\n   * @param key\n   * @returns\n   */\n  static getFunction(key: string): Function | null {\n    if (!key) {\n      return null;\n    }\n    return ExpressionFunction.instance().getFunction(key);\n  }\n\n  /**\n   * 获取函数列表（全局获取）\n   * @returns\n   */\n  static getFunctionList(): string[] | null {\n    return ExpressionFunction.instance().getFunctionNameList();\n  }\n\n  /**\n   * 注册地图数据\n   * @param key 地图名称\n   * @param source 地图数据\n   * @param option 地图数据配置\n   */\n  static registerMap(key: string, source: GeoSourceType, option?: GeoSourceOption) {\n    const impl = Factory.getImplementInKey('registerMap');\n    impl && impl(key, source, option);\n  }\n\n  /**\n   * 注销地图数据\n   * @param key 地图名称\n   */\n  static unregisterMap(key: string) {\n    const impl = Factory.getImplementInKey('unregisterMap');\n    impl && impl(key);\n  }\n\n  /**\n   * 根据地图名称获取地图数据\n   * @param key 地图名称\n   * @returns 地图数据\n   */\n  static getMap(key: string): GeoSourceType {\n    return getMapSource(key);\n  }\n\n  /**\n   * 全局关闭 tooltip\n   * @param excludeId 可选，指定不需要关闭 tooltip 的实例 id\n   */\n  static hideTooltip(excludeId: MaybeArray<number> = []): void {\n    InstanceManager.forEach(instance => instance?.hideTooltip?.(), excludeId);\n  }\n\n  /** 获取 Logger */\n  static getLogger(): ILogger {\n    return Logger.getInstance();\n  }\n\n  /** 图表实例管理器 */\n  static readonly InstanceManager = InstanceManager;\n  /** 主题管理器 */\n  static readonly ThemeManager = ThemeManager;\n\n  /** 全局配置 */\n  static globalConfig: IGlobalConfig = {\n    uniqueTooltip: true\n  };\n\n  /** 工具方法 */\n  static readonly Utils = VCHART_UTILS;\n\n  protected _originalSpec: any;\n  protected _spec: any;\n  getSpec() {\n    return this._spec;\n  }\n\n  protected _specInfo: IChartSpecInfo;\n  getSpecInfo() {\n    return this._specInfo;\n  }\n\n  private _viewBox: IBoundsLike;\n  private _chart!: Maybe<IChart>;\n  private _chartSpecTransformer!: Maybe<IChartSpecTransformer>;\n  private _compiler: Compiler;\n  private _event: Maybe<IEvent>;\n  private _userEvents: {\n    eType: EventType;\n    query: EventQuery | EventCallback<EventParamsDefinition[EventType]>;\n    handler?: EventCallback<EventParamsDefinition[EventType]>;\n  }[] = [];\n  private _eventDispatcher: Maybe<IEventDispatcher>;\n  private _dataSet!: Maybe<DataSet>;\n  getDataSet() {\n    return this._dataSet;\n  }\n\n  private _container?: HTMLElement;\n  private _canvas?: HTMLCanvasElement | OffscreenCanvas | string;\n  private _stage?: Stage;\n\n  private _autoSize: boolean = true;\n  private _option: IInitOption = {\n    mode: RenderModeEnum['desktop-browser'],\n    onError: (msg: string) => {\n      throw new Error(msg);\n    },\n    optimize: {\n      disableCheckGraphicWidthOutRange: true\n    }\n  };\n\n  private _currentSize: { width: number; height: number };\n  private _observer: ResizeObserver = null;\n\n  private _currentThemeName: string;\n  private _currentTheme: ITheme;\n\n  private _onError?: (...args: any[]) => void;\n\n  private _context: any = {}; // 存放用户在model初始化前通过实例方法传入的配置等\n  private _isReleased: boolean;\n\n  private _chartPlugin?: IChartPluginService;\n\n  constructor(spec: ISpec, options: IInitOption) {\n    this._option = mergeOrigin(this._option, { animation: (spec as any).animation !== false }, options);\n    this._onError = this._option?.onError;\n\n    const { dom, renderCanvas, mode, stage, poptip, ...restOptions } = this._option;\n    const isTrueBrowseEnv = isTrueBrowser(mode);\n\n    if (isTrueBrowseEnv && dom) {\n      this._container = isString(dom) ? document?.getElementById(dom) : dom;\n    }\n    if (renderCanvas) {\n      this._canvas = renderCanvas;\n    }\n    if (stage) {\n      this._stage = stage as unknown as Stage; // FIXME: 等待 vrender 解决类型和接口不匹配的问题 @zhouxinyu\n    }\n\n    if (mode !== 'node' && !this._container && !this._canvas && !this._stage) {\n      this._option?.onError('please specify container or renderCanvas!');\n      return;\n    }\n    // 根据 mode 配置动态加载浏览器或 node 环境代码\n    if (isTrueBrowseEnv) {\n      registerBrowserEnv();\n    } else if (mode === 'node') {\n      registerNodeEnv();\n    }\n\n    this._viewBox = this._option.viewBox;\n    this._currentThemeName = ThemeManager.getCurrentThemeName();\n    this._setNewSpec(spec);\n    this._updateCurrentTheme();\n    this._currentSize = this.getCurrentSize();\n    this._compiler = new Compiler(\n      {\n        dom: this._container ?? 'none',\n        canvas: renderCanvas\n      },\n      {\n        mode: this._option.mode,\n        stage,\n        pluginList: poptip !== false ? ['poptipForText'] : [],\n        ...restOptions,\n        background: this._getBackground(),\n        onError: this._onError\n      }\n    );\n    this._compiler.setSize(this._currentSize.width, this._currentSize.height);\n    this._eventDispatcher = new EventDispatcher(this, this._compiler);\n    this._event = new Event(this._eventDispatcher, mode);\n    this._compiler.initView();\n    // TODO: 如果通过 updateSpec 更新主题字体的验证\n    // 设置全局字体\n    this.getStage()?.setTheme({\n      text: { fontFamily: this._currentTheme?.fontFamily }\n    });\n    this._initDataSet(this._option.dataSet);\n    this._autoSize = isTrueBrowseEnv ? spec.autoFit ?? this._option.autoFit ?? true : false;\n    this._bindResizeEvent();\n    this._bindVGrammarViewEvent();\n    this._initChartPlugin();\n\n    InstanceManager.registerInstance(this);\n  }\n\n  /** 设置新 spec，返回是否成功 */\n  private _setNewSpec(spec: any, forceMerge?: boolean): boolean {\n    if (!spec) {\n      return false;\n    }\n    if (isString(spec)) {\n      spec = JSON.parse(spec);\n    }\n    if (forceMerge && this._originalSpec) {\n      spec = mergeSpec({}, this._originalSpec, spec);\n    }\n    this._originalSpec = spec;\n    this._spec = this._getSpecFromOriginalSpec();\n    return true;\n  }\n\n  private _getSpecFromOriginalSpec() {\n    // 转换在实例上注册的函数 + 深拷贝 spec，保证 _originalSpec 和 _spec 的不同\n    const spec = specTransform(this._originalSpec) as any;\n    // because of in data-init, data will be set as array;\n    spec.data = spec.data ?? [];\n    return spec;\n  }\n\n  private _initChartSpec(spec: any, actionSource: VChartRenderActionSource) {\n    // 如果用户注册了函数，在配置中替换相应函数名为函数内容\n    if (VChart.getFunctionList() && VChart.getFunctionList().length) {\n      spec = functionTransform(spec, VChart);\n    }\n    this._spec = spec;\n    if (!this._chartSpecTransformer) {\n      this._chartSpecTransformer = Factory.createChartSpecTransformer(this._spec.type, {\n        type: this._spec.type,\n        getTheme: () => this._currentTheme ?? {},\n        animation: this._option.animation\n      });\n    }\n\n    this._chartSpecTransformer.transformSpec(this._spec);\n\n    // 插件生命周期\n    this._chartPluginApply('onAfterChartSpecTransform', this._spec, actionSource);\n\n    this._specInfo = this._chartSpecTransformer?.transformModelSpec(this._spec);\n\n    // 插件生命周期\n    this._chartPluginApply('onAfterModelSpecTransform', this._spec, this._specInfo, actionSource);\n  }\n\n  private _updateSpecInfo() {\n    if (!this._chartSpecTransformer) {\n      this._chartSpecTransformer = Factory.createChartSpecTransformer(this._spec.type, {\n        type: this._spec.type,\n        getTheme: () => this._currentTheme ?? {}\n      });\n    }\n    this._specInfo = this._chartSpecTransformer?.createSpecInfo(this._spec);\n  }\n\n  private _initChart(spec: any) {\n    if (!this._compiler) {\n      this._option?.onError('compiler is not initialized');\n      return;\n    }\n\n    // 放到这里而不是放到chart内的考虑\n    // 用户spec更新，也许会有core上图表实例的内容存在\n    // 如果要支持spec的类似Proxy监听，更新逻辑应当从这一层开始。如果在chart上做，就需要在再向上发送spec更新消息，不是很合理。\n    // todo: 问题1 存不存在 chart 需要在这个阶段处理的特殊字段？目前没有，但是理论上可以有？\n    const chart = Factory.createChart(spec.type, spec, {\n      type: spec.type,\n      globalInstance: this,\n      eventDispatcher: this._eventDispatcher!,\n      dataSet: this._dataSet!,\n      container: this._container,\n      canvas: this._canvas,\n      map: new Map(),\n      mode: this._option.mode || RenderModeEnum['desktop-browser'],\n      modeParams: this._option.modeParams,\n      getCompiler: () => this._compiler,\n      performanceHook: this._option.performanceHook,\n      viewBox: this._viewBox,\n      animation: this._option.animation,\n      getTheme: () => this._currentTheme ?? {},\n      getSpecInfo: () => this._specInfo ?? {},\n\n      layout: this._option.layout,\n      onError: this._onError,\n      disableTriggerEvent: this._option.disableTriggerEvent === true\n    });\n    if (!chart) {\n      this._option?.onError('init chart fail');\n      return;\n    }\n    this._chart = chart;\n    this._chart.setCanvasRect(this._currentSize.width, this._currentSize.height);\n    this._chart.created();\n    this._chart.init();\n    this._event.emit(ChartEvent.initialized, {});\n  }\n\n  private _releaseData() {\n    if (this._dataSet) {\n      // Object.values(this._dataSet.dataViewMap).forEach(d => {\n      //   d.target.removeAllListeners();\n      //   d.destroy();\n      // });\n      this._dataSet.dataViewMap = {};\n      this._dataSet = null;\n    }\n  }\n\n  private _bindVGrammarViewEvent() {\n    if (!this._compiler || this._compiler.isReleased) {\n      return;\n    }\n    this._compiler.getVGrammarView().addEventListener(VGRAMMAR_HOOK_EVENT.ALL_ANIMATION_END, () => {\n      this._event.emit(ChartEvent.animationFinished, {});\n    });\n    this._compiler.getVGrammarView().addEventListener(VGRAMMAR_HOOK_EVENT.AFTER_VRENDER_NEXT_RENDER, () => {\n      this._event.emit(ChartEvent.renderFinished, {});\n    });\n  }\n\n  private _bindResizeEvent() {\n    if (this._autoSize) {\n      if (this._container) {\n        const ResizeObserverWindow: any = window.ResizeObserver;\n        this._observer = new ResizeObserverWindow(this._onResize);\n        this._observer?.observe(this._container);\n      }\n      window.addEventListener('resize', this._onResize);\n    }\n  }\n\n  private _unBindResizeEvent() {\n    if (this._autoSize) {\n      window.removeEventListener('resize', this._onResize);\n      if (this._observer) {\n        this._observer.disconnect();\n        this._observer = null;\n      }\n    }\n  }\n\n  getCurrentSize() {\n    return calculateChartSize(\n      this._spec,\n      {\n        container: this._container,\n        canvas: this._canvas,\n        mode: this._option.mode || RenderModeEnum['desktop-browser'],\n        modeParams: this._option.modeParams\n      },\n      {\n        width: this._currentSize?.width ?? DEFAULT_CHART_WIDTH,\n        height: this._currentSize?.height ?? DEFAULT_CHART_HEIGHT\n      }\n    );\n  }\n\n  private _doResize() {\n    const { width, height } = this.getCurrentSize();\n    if (this._currentSize.width !== width || this._currentSize.height !== height) {\n      this._currentSize = { width, height };\n      this.resize(width, height);\n    }\n  }\n\n  private _onResize = debounce((...args: any[]) => {\n    this._doResize();\n  }, 100);\n\n  private _initDataSet(dataSet?: DataSet) {\n    if (dataSet instanceof DataSet) {\n      this._dataSet = dataSet;\n    } else {\n      this._dataSet = new DataSet();\n    }\n    registerDataSetInstanceParser(this._dataSet, 'dataview', dataViewParser);\n    registerDataSetInstanceParser(this._dataSet, 'array', arrayParser);\n    registerDataSetInstanceTransform(this._dataSet, 'stackSplit', stackSplit);\n    registerDataSetInstanceTransform(this._dataSet, 'copyDataView', copyDataView);\n    // 注册 dataset transform\n    for (const key in Factory.transforms) {\n      registerDataSetInstanceTransform(this._dataSet, key, Factory.transforms[key]);\n    }\n    // 注册 dataview parser\n    for (const key in Factory.dataParser) {\n      registerDataSetInstanceParser(this._dataSet, key, Factory.dataParser[key]);\n    }\n  }\n\n  /** 在修改图表配置后重新渲染 */\n  updateCustomConfigAndRerender(\n    updateSpecResult: IUpdateSpecResult | (() => IUpdateSpecResult),\n    sync?: boolean,\n    option: IVChartRenderOption = {}\n  ) {\n    if (this._isReleased || !updateSpecResult) {\n      return undefined;\n    }\n    if (isFunction(updateSpecResult)) {\n      updateSpecResult = updateSpecResult();\n    }\n    this._reCompile(updateSpecResult);\n    if (sync) {\n      return this._renderSync(option);\n    }\n    return this._renderAsync(option);\n  }\n\n  /** 执行自定义的回调修改图表配置，并重新编译（不渲染） */\n  protected _updateCustomConfigAndRecompile(updateSpecResult: IUpdateSpecResult, option: IVChartRenderOption = {}) {\n    if (!updateSpecResult) {\n      return false;\n    }\n    this._reCompile(updateSpecResult);\n    return this._beforeRender(option);\n  }\n\n  protected _reCompile(updateResult: IUpdateSpecResult, morphConfig?: IMorphConfig) {\n    if (updateResult.reMake) {\n      this._releaseData();\n      this._initDataSet();\n      // 释放图表等等\n      this._chartSpecTransformer = null;\n      this._chart.release();\n      this._chart = null as unknown as IChart;\n      // 如果不需要动画，那么释放item，避免元素残留\n      this._compiler?.releaseGrammar(this._option?.animation === false || this._spec?.animation === false);\n      // chart 内部事件 模块自己必须删除\n      // 内部模块删除事件时，调用了event Dispatcher.release() 导致用户事件被一起删除\n      // 外部事件现在需要重新添加\n      this._userEvents.forEach(e => this._event?.on(e.eType as any, e.query as any, e.handler as any));\n\n      if (updateResult.reSize) {\n        this._doResize();\n      }\n    } else {\n      if (updateResult.reCompile) {\n        // recompile\n        // 清除之前的所有 compile 内容\n        this._compiler?.clear({ chart: this._chart, vChart: this }, !this._option.animation || !this._spec.animation);\n        // TODO: 释放事件？ vgrammar 的 view 应该不需要释放，响应的stage也没有释放，所以事件可以不绑定\n        // 重新绑定事件\n        // TODO: 释放XX？\n        // 重新compile\n        this._compiler?.compile({ chart: this._chart, vChart: this }, {});\n      }\n      if (updateResult.reSize) {\n        const { width, height } = this.getCurrentSize();\n        this._chart.onResize(width, height, false);\n        this._compiler.resize?.(width, height, false);\n      }\n    }\n  }\n\n  /** 渲染之前的步骤，返回是否成功 */\n  protected _beforeRender(option: IVChartRenderOption = {}): boolean {\n    // 如果 vchart 实例已经卸载，终止渲染\n    if (this._isReleased) {\n      return false;\n    }\n    // 如果图表已经实例化，跳过该步骤\n    if (this._chart) {\n      return true;\n    }\n\n    const { transformSpec, actionSource } = option;\n    if (transformSpec) {\n      // 初始化图表 spec\n      this._initChartSpec(this._spec, 'render');\n    }\n\n    // 插件生命周期\n    this._chartPluginApply('onBeforeInitChart', this._spec, actionSource);\n\n    // 实例化图表\n    this._option.performanceHook?.beforeInitializeChart?.();\n    this._initChart(this._spec);\n    this._option.performanceHook?.afterInitializeChart?.();\n    // 如果实例化失败，终止渲染\n    if (!this._chart || !this._compiler) {\n      return false;\n    }\n\n    // compile\n    this._option.performanceHook?.beforeCompileToVGrammar?.();\n    this._compiler.compile({ chart: this._chart, vChart: this }, { performanceHook: this._option.performanceHook });\n    this._option.performanceHook?.afterCompileToVGrammar?.();\n    return true;\n  }\n\n  /** 渲染之后的步骤 */\n  protected _afterRender(): boolean {\n    if (this._isReleased) {\n      return false;\n    }\n    this._updateAnimateState();\n    this._event.emit(ChartEvent.rendered, {});\n    return true;\n  }\n\n  /**\n   * **同步方法** 渲染图表。\n   * @param morphConfig 图表 morph 动画配置，可选\n   * @returns VChart 实例\n   */\n  renderSync(morphConfig?: IMorphConfig) {\n    return this._renderSync({\n      morphConfig,\n      transformSpec: true,\n      actionSource: 'render'\n    });\n  }\n\n  /**\n   * **异步方法** 渲染图表。\n   * @param morphConfig 图表 morph 动画配置，可选\n   * @returns VChart 实例\n   */\n  async renderAsync(morphConfig?: IMorphConfig) {\n    return this._renderAsync({\n      morphConfig,\n      transformSpec: true,\n      actionSource: 'render'\n    });\n  }\n\n  protected _renderSync(option: IVChartRenderOption = {}) {\n    const self = this as unknown as IVChart;\n    if (!this._beforeRender(option)) {\n      return self;\n    }\n    // 填充数据绘图\n    this._compiler?.renderSync(option.morphConfig);\n    this._afterRender();\n    return self;\n  }\n\n  protected async _renderAsync(option: IVChartRenderOption = {}) {\n    const self = this as unknown as IVChart;\n    if (!this._beforeRender(option)) {\n      return self;\n    }\n    // 填充数据绘图\n    await this._compiler?.renderAsync(option.morphConfig);\n    this._afterRender();\n    return self;\n  }\n\n  private _updateAnimateState() {\n    if (this._option.animation) {\n      this._chart?.getAllRegions().forEach(region => {\n        region.animate?.updateAnimateState(AnimationStateEnum.update, true);\n      });\n      this._chart?.getAllComponents().forEach(component => {\n        component.animate?.updateAnimateState(AnimationStateEnum.update, true);\n      });\n    }\n  }\n\n  /**\n   * 销毁图表\n   */\n  release() {\n    if ((this._onResize as any)?.cancel) {\n      (this._onResize as any).cancel();\n    }\n    this._chartPluginApply('disposeAll');\n    this._chartSpecTransformer = null;\n    this._chart?.release();\n    this._compiler?.release();\n    this._eventDispatcher?.release();\n    this._unBindResizeEvent();\n    // resetID(); // 为什么要重置ID呢？\n\n    this._releaseData();\n\n    this._chart = null;\n    this._compiler = null;\n    this._spec = null;\n    this._originalSpec = null;\n    // this._option = null;\n    this._userEvents = null;\n    this._event = null;\n    this._eventDispatcher = null;\n    this._isReleased = true;\n\n    InstanceManager.unregisterInstance(this);\n  }\n\n  /**\n   * **异步方法** 更新数据。\n   * @param id 数据 id\n   * @param data 数据值\n   * @param options 数据参数\n   * @returns VChart 实例\n   */\n  async updateData(id: StringOrNumber, data: DataView | Datum[] | string, options?: IParserOptions): Promise<IVChart> {\n    if (isNil(this._dataSet)) {\n      return this as unknown as IVChart;\n    }\n    if (this._chart) {\n      this._chart.updateData(id, data, true, options);\n\n      // after layout\n      await this._compiler.renderAsync();\n      return this as unknown as IVChart;\n    }\n    this._spec.data = array(this._spec.data);\n    const preDV = this._spec.data.find((dv: any) => dv.name === id || dv.id === id);\n    if (preDV) {\n      if (preDV.id === id) {\n        preDV.values = data;\n      } else if (preDV.name === id) {\n        preDV.parse(data, options);\n      }\n    } else {\n      if (isArray(data)) {\n        this._spec.data.push({\n          id,\n          values: data\n        });\n      } else {\n        this._spec.data.push(data);\n      }\n    }\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **异步方法** 批量更新数据。\n   * @param list 待更新的数据列表\n   * @returns VChart 实例\n   */\n  async updateDataInBatches(list: { id: string; data: Datum[]; options?: IParserOptions }[]): Promise<IVChart> {\n    if (this._chart) {\n      this._chart.updateFullData(\n        list.map(({ id, data, options }) => {\n          return { id, values: data, parser: options };\n        })\n      );\n      this._chart.updateGlobalScaleDomain();\n      await this._compiler.renderAsync();\n      return this as unknown as IVChart;\n    }\n    list.forEach(({ id, data, options }) => {\n      const preDV = (this._spec.data as DataView[]).find(dv => dv.name === id);\n      if (preDV) {\n        preDV.parse(data, options);\n      } else {\n        const dataView = new DataView(this._dataSet, { name: id });\n        dataView.parse(data, options);\n        this._spec.data.push(dataView);\n      }\n    });\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **同步方法** 更新数据\n   * @param id 数据 id\n   * @param data 数据值\n   * @param options 数据参数\n   * @returns VChart 实例\n   */\n  updateDataSync(id: StringOrNumber, data: DataView | Datum[], options?: IParserOptions) {\n    if (isNil(this._dataSet)) {\n      return this as unknown as IVChart;\n    }\n    if (this._chart) {\n      this._chart.updateData(id, data, true, options);\n      // after layout\n      this._compiler.renderSync();\n      return this as unknown as IVChart;\n    }\n    const preDV = (this._spec.data as DataView[]).find(dv => dv.name === id);\n    if (preDV) {\n      preDV.parse(data, options);\n    } else {\n      const dataView = new DataView(this._dataSet, { name: id as string });\n      dataView.parse(data, options);\n      this._spec.data.push(dataView);\n    }\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **同步方法** 更新数据\n   * @param data 图表配置结构中的数据对象\n   * @returns VChart 实例\n   * @since 1.3.0\n   */\n  updateFullDataSync(data: IDataValues | IDataValues[], reRender: boolean = true) {\n    if (this._chart) {\n      this._chart.updateFullData(data);\n      if (reRender) {\n        this._compiler.renderSync();\n      }\n      return this as unknown as IVChart;\n    }\n    const list: IDataValues[] = array(data);\n    list.forEach(d => {\n      // only support update this attrs\n      const { id, values, parser, fields } = d;\n      const preDV = (this._spec.data as DataView[]).find(dv => dv.name === id);\n      if (preDV) {\n        preDV.setFields(cloneDeep(fields) as IFields);\n        preDV.parse(values, cloneDeep(parser) as IParserOptions);\n      } else {\n        // new data\n        const dataView = dataToDataView(d, <DataSet>this._dataSet, this._spec.data, {\n          onError: this._option?.onError\n        });\n        this._spec.data.push(dataView);\n      }\n    });\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **异步方法** 更新数据\n   * @param data 图表配置结构中的数据对象\n   * @returns VChart 实例\n   * @since 1.3.0\n   */\n  async updateFullData(data: IDataValues | IDataValues[], reRender: boolean = true) {\n    if (this._chart) {\n      this._chart.updateFullData(data);\n      if (reRender) {\n        await this._compiler.renderAsync();\n      }\n      return this as unknown as IVChart;\n    }\n    const list: IDataValues[] = array(data);\n    list.forEach(d => {\n      // only support update this attrs\n      const { id, values, parser, fields } = d;\n      const preDV = (this._spec.data as DataView[]).find(dv => dv.name === id);\n      if (preDV) {\n        preDV.setFields(cloneDeep(fields) as IFields);\n        preDV.parse(values, cloneDeep(parser) as IParserOptions);\n      } else {\n        // new data\n        const dataView = dataToDataView(d, <DataSet>this._dataSet, this._spec.data, {\n          onError: this._option?.onError\n        });\n        this._spec.data.push(dataView);\n      }\n    });\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **异步方法** spec 更新\n   * @param spec\n   * @param forceMerge\n   * @returns\n   */\n  async updateSpec(spec: ISpec, forceMerge: boolean = false, morphConfig?: IMorphConfig) {\n    const result = this._updateSpec(spec, forceMerge);\n    await this.updateCustomConfigAndRerender(result, false, {\n      morphConfig,\n      transformSpec: true,\n      actionSource: 'updateSpec'\n    });\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **同步方法** spec 更新\n   * @param spec\n   * @param forceMerge\n   * @returns\n   */\n  updateSpecSync(spec: ISpec, forceMerge: boolean = false, morphConfig?: IMorphConfig) {\n    const result = this._updateSpec(spec, forceMerge);\n    this.updateCustomConfigAndRerender(result, true, {\n      morphConfig,\n      transformSpec: true,\n      actionSource: 'updateSpec'\n    });\n    return this as unknown as IVChart;\n  }\n\n  /** 更新 spec 并重新编译（不渲染），返回是否成功 */\n  updateSpecAndRecompile(spec: ISpec, forceMerge: boolean = false, option: IVChartRenderOption = {}) {\n    const result = this._updateSpec(spec, forceMerge);\n    return this._updateCustomConfigAndRecompile(result, {\n      actionSource: 'updateSpecAndRecompile',\n      ...option\n    });\n  }\n\n  private _updateSpec(spec: ISpec, forceMerge: boolean = false): IUpdateSpecResult | undefined {\n    const lastSpec = this._spec;\n    if (!this._setNewSpec(spec, forceMerge)) {\n      return undefined;\n    }\n\n    if (!isEqual(lastSpec.theme, this._spec.theme)) {\n      this._setCurrentTheme();\n    }\n\n    const reSize = this._shouldChartResize(lastSpec);\n    this._compiler?.getVGrammarView()?.updateLayoutTag();\n\n    return mergeUpdateResult(this._chart.updateSpec(this._spec), {\n      change: reSize,\n      reMake: false,\n      reCompile: false,\n      reSize\n    });\n  }\n\n  /**\n   * **异步方法** spec 更新\n   * @param filter\n   * @param spec\n   * @param forceMerge\n   * @returns\n   * @sync 1.4.0\n   */\n  async updateModelSpec(\n    filter: string | { type: string; index: number } | ((model: IModel) => boolean),\n    spec: unknown,\n    forceMerge: boolean = false,\n    morphConfig?: IMorphConfig\n  ) {\n    if (!spec || !this._spec) {\n      return this as unknown as IVChart;\n    }\n    if (isString(spec)) {\n      spec = JSON.parse(spec);\n    }\n\n    if (!isFunction(filter)) {\n      // find spec and update\n      mergeSpecWithFilter(this._spec, filter, spec, forceMerge);\n    }\n\n    if (this._chart) {\n      const model = this._chart.getModelInFilter(filter);\n      if (model) {\n        return this._updateModelSpec(model, spec, false, forceMerge, morphConfig);\n      }\n    }\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **同步方法** spec 更新\n   * @param filter\n   * @param spec\n   * @param forceMerge\n   * @returns\n   * @sync 1.4.0\n   */\n  updateModelSpecSync(\n    filter: string | { type: string; index: number } | ((model: IModel) => boolean),\n    spec: unknown,\n    forceMerge: boolean = false,\n    morphConfig?: IMorphConfig\n  ) {\n    if (!spec || !this._spec) {\n      return this as unknown as IVChart;\n    }\n    if (isString(spec)) {\n      spec = JSON.parse(spec);\n    }\n\n    if (!isFunction(filter)) {\n      // find spec and update\n      mergeSpecWithFilter(this._spec, filter, spec, forceMerge);\n    }\n\n    if (this._chart) {\n      const model = this._chart.getModelInFilter(filter);\n      if (model) {\n        return this._updateModelSpec(model, spec, true, forceMerge, morphConfig) as IVChart;\n      }\n    }\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **同步方法** 模块 spec 更新\n   * @param model\n   * @param spec\n   * @param forceMerge\n   * @returns\n   */\n  protected _updateModelSpec(\n    model: IModel,\n    spec: unknown,\n    sync: boolean = false,\n    forceMerge: boolean = false,\n    morphConfig?: IMorphConfig\n  ) {\n    if (forceMerge) {\n      spec = mergeSpec({}, model.getSpec(), spec);\n    }\n\n    const result = model.updateSpec(spec);\n    model.reInit(spec);\n    if (result.change || result.reCompile || result.reMake || result.reSize || result.reRender) {\n      this._chart.reDataFlow();\n    }\n\n    return this.updateCustomConfigAndRerender(result, sync, {\n      morphConfig,\n      transformSpec: false,\n      actionSource: 'updateModelSpec'\n    });\n  }\n\n  /**\n   * **异步方法**，图表尺寸更新方法\n   * @param width 宽度\n   * @param height 高度\n   * @returns VChart 当前实例\n   */\n  async resize(width: number, height: number) {\n    if (!this._chart || !this._compiler) {\n      return this as unknown as IVChart;\n    }\n    // 如果宽高未变化，不需要重新执行 resize，防止当图表初始化时会执行一次多余的 resize\n    const chartCanvasRect = this._chart.getCanvasRect();\n    if (chartCanvasRect && chartCanvasRect.width === width && chartCanvasRect.height === height) {\n      return this as unknown as IVChart;\n    }\n\n    // 插件生命周期\n    this._chartPluginApply('onBeforeResize', width, height);\n\n    this._option.performanceHook?.beforeResizeWithUpdate?.();\n    this._chart.onResize(width, height, false);\n    this._option.performanceHook?.afterResizeWithUpdate?.();\n\n    await this._compiler.resize?.(width, height);\n\n    if (this._isReleased) {\n      return this as unknown as IVChart;\n    }\n    // emit resize event\n    this._event.emit(ChartEvent.afterResize, { chart: this._chart });\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * 更新绘制区域\n   * @param viewBox 绘制区域\n   * @param reRender 是否重新渲染，默认为 true\n   * @param reLayout 是否重新布局，默认为 true\n   * @returns\n   */\n  updateViewBox(viewBox: IBoundsLike, reRender: boolean = true, reLayout: boolean = true) {\n    if (!this._chart || !this._compiler) {\n      return this as unknown as IVChart;\n    }\n    this._viewBox = viewBox;\n    // 更新 layout 参数\n    this._chart.updateViewBox(viewBox, reLayout);\n    if (reLayout) {\n      // 重新布局\n      this._compiler.renderSync();\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      this._chart.onEvaluateEnd();\n    }\n    // 获取 compiler\n    this._compiler.updateViewBox(viewBox, reRender);\n    return this as unknown as IVChart;\n  }\n\n  // 事件相关方法\n  on(eType: EventType, handler: EventCallback<EventParams>): void;\n  on(eType: EventType, query: EventQuery, handler: EventCallback<EventParams>): void;\n  on(eType: EventType, query: EventQuery | EventCallback<EventParams>, handler?: EventCallback<EventParams>): void {\n    if (!this._userEvents) {\n      // userEvents正常情况下有默认值，如果!userEvents，说明此时chart被release了，就可以终止流程\n      return;\n    }\n    this._userEvents.push({\n      eType,\n      query: typeof query === 'function' ? null : query,\n      handler: typeof query === 'function' ? query : handler\n    });\n    this._event?.on(eType as any, query as any, handler as any);\n  }\n  off(eType: string, handler?: EventCallback<EventParams>): void {\n    if (!this._userEvents || this._userEvents.length === 0) {\n      return;\n    }\n    if (handler) {\n      const index = this._userEvents.findIndex(e => e.eType === eType && e.handler === handler);\n      if (index >= 0) {\n        this._userEvents.splice(index, 1);\n        this._event?.off(eType, handler);\n      }\n    } else {\n      this._userEvents.forEach(e => {\n        if (e.eType === eType) {\n          this._event?.off(eType, e.handler);\n        }\n      });\n      this._userEvents = this._userEvents.filter(e => e.eType !== eType);\n    }\n  }\n\n  // 状态相关方法\n  /**\n   * 更新或设置图元状态\n   * @param state 状态筛选器\n   * @param filter 筛选器\n   */\n  updateState(\n    state: Record<string, Omit<IMarkStateSpec<unknown>, 'style'>>,\n    filter?: (series: ISeries, mark: IMark, stateKey: string) => boolean //series + mark 筛选\n  ): void {\n    if (!this._chart) {\n      return;\n    }\n    this._chart.updateState(state, filter);\n  }\n\n  /**\n   * 更新图元选中状态\n   * @param datum hover 图元数据\n   * @param filter 筛选器 用来筛选系列与mark\n   * @param region region 筛选器\n   */\n  setSelected(\n    datum: MaybeArray<any> | null,\n    filter?: (series: ISeries, mark: IMark) => boolean,\n    region?: IRegionQuerier\n  ): void {\n    if (!this._chart) {\n      return;\n    }\n    this._chart.setSelected(datum, filter, region);\n  }\n\n  /**\n   * 更新图元 hover 状态\n   * @param datum hover 图元数据\n   * @param filter 筛选器 用来筛选系列与mark\n   * @param region region 筛选器\n   */\n  setHovered(\n    datum: MaybeArray<Datum> | null,\n    filter?: (series: ISeries, mark: IMark) => boolean,\n    region?: IRegionQuerier\n  ): void {\n    if (!this._chart) {\n      return;\n    }\n    this._chart.setHovered(datum, filter, region);\n  }\n\n  // 主题相关方法\n  /**\n   * 当 spec 或者 currentThemeName 有变化时需要调用此方法对 currentTheme 进行更新\n   * @param nextThemeName 通过 setCurrentTheme 方法新设的主题\n   */\n  private _updateCurrentTheme(nextThemeName?: string) {\n    const optionTheme: Maybe<string | ITheme> = this._option.theme;\n    const specTheme: Maybe<string | ITheme> = this._spec?.theme;\n\n    if (nextThemeName) {\n      this._currentThemeName = nextThemeName;\n    }\n\n    // 处理 specTheme 和 optionTheme, merge -> transform\n    // 优先级 currentTheme < optionTheme < specTheme\n    if (!isEmpty(optionTheme) || !isEmpty(specTheme)) {\n      if (\n        (isString(optionTheme) && (!specTheme || isString(specTheme))) ||\n        (isString(specTheme) && (!optionTheme || isString(optionTheme)))\n      ) {\n        const finalTheme = mergeTheme(\n          {},\n          getThemeObject(this._currentThemeName, true),\n          getThemeObject(optionTheme, true),\n          getThemeObject(specTheme, true)\n        );\n        this._currentTheme = finalTheme;\n      } else {\n        const finalTheme = mergeTheme(\n          {},\n          getThemeObject(this._currentThemeName),\n          getThemeObject(optionTheme),\n          getThemeObject(specTheme)\n        );\n        this._currentTheme = preprocessTheme(finalTheme, finalTheme.colorScheme);\n      }\n    } else {\n      this._currentTheme = getThemeObject(this._currentThemeName, true);\n    }\n\n    // 设置 poptip 的主题\n    setPoptipTheme(get(this._currentTheme, 'component.poptip'));\n    // 设置背景色\n    this._compiler?.setBackground(this._getBackground());\n  }\n\n  private _shouldChartResize(oldSpec: ISpec): boolean {\n    let resize = false;\n\n    if (isNil(this._spec.width)) {\n      this._spec.width = oldSpec.width;\n    } else if (this._spec.width !== oldSpec.width) {\n      resize = true;\n    }\n\n    if (isNil(this._spec.height)) {\n      this._spec.height = oldSpec.height;\n    } else if (this._spec.height !== oldSpec.height) {\n      resize = true;\n    }\n\n    const lasAutoSize = this._autoSize;\n    this._autoSize = isTrueBrowser(this._option.mode) ? this._spec.autoFit ?? this._option.autoFit ?? true : false;\n    if (this._autoSize !== lasAutoSize) {\n      resize = true;\n    }\n    return resize;\n  }\n\n  private _getBackground() {\n    const specBackground = typeof this._spec.background === 'string' ? this._spec.background : null;\n    // spec > spec.theme > initOptions.theme\n    return specBackground || (this._currentTheme.background as string) || this._option.background;\n  }\n\n  /**\n   * 获取当前主题，会返回完整的主题配置（只能获取用户通过`setCurrentTheme`方法设置过的主题，默认值为`ThemeManager`统一设置的主题）\n   * */\n  getCurrentTheme() {\n    return getThemeObject(this._currentThemeName);\n  }\n\n  /**\n   * 获取当前主题名称（只能获取用户通过`setCurrentTheme`方法设置过的主题，默认值为`ThemeManager`统一设置的主题）\n   */\n  getCurrentThemeName() {\n    return this._currentThemeName;\n  }\n\n  /**\n   * **异步方法**， 设置当前主题。\n   * **注意，如果在 spec 上配置了 theme，则 spec 上的 theme 优先级更高。**\n   * @param name 主题名称\n   * @returns\n   */\n  async setCurrentTheme(name: string) {\n    if (!ThemeManager.themeExist(name)) {\n      return this as unknown as IVChart;\n    }\n    const result = this._setCurrentTheme(name);\n    await this.updateCustomConfigAndRerender(result, false, {\n      transformSpec: false,\n      actionSource: 'setCurrentTheme'\n    });\n    return this as unknown as IVChart;\n  }\n\n  /**\n   * **同步方法** 设置当前主题。\n   * **注意，如果在 spec 上配置了 theme，则 spec 上的 theme 优先级更高。**\n   * @param name 主题名称\n   * @returns\n   */\n  setCurrentThemeSync(name: string) {\n    if (!ThemeManager.themeExist(name)) {\n      return this as unknown as IVChart;\n    }\n    const result = this._setCurrentTheme(name);\n    this.updateCustomConfigAndRerender(result, true, {\n      transformSpec: false,\n      actionSource: 'setCurrentTheme'\n    });\n    return this as unknown as IVChart;\n  }\n\n  protected _setCurrentTheme(name?: string): IUpdateSpecResult {\n    this._updateCurrentTheme(name);\n    this._initChartSpec(this._getSpecFromOriginalSpec(), 'setCurrentTheme');\n    this._chart?.setCurrentTheme();\n    return { change: true, reMake: false };\n  }\n\n  // Tooltip 相关方法\n  private _getTooltipComponent(): Tooltip | undefined {\n    const tooltip = this._chart?.getAllComponents().find(c => c.type === ComponentTypeEnum.tooltip) as Tooltip;\n    return tooltip;\n  }\n\n  /**\n   * 自定义 TooltipHandler\n   * @param tooltipHandler\n   */\n  setTooltipHandler(tooltipHandler: ITooltipHandler) {\n    this._context.tooltipHandler = tooltipHandler;\n    const tooltip = this._getTooltipComponent();\n    if (tooltip) {\n      tooltip.tooltipHandler?.release?.();\n      tooltip.tooltipHandler = tooltipHandler;\n    }\n  }\n\n  /**\n   * 获取用户定义的 TooltipHandler\n   * @returns ITooltipHandler\n   */\n  getTooltipHandlerByUser(): ITooltipHandler | undefined {\n    return this._context?.tooltipHandler;\n  }\n\n  /**\n   * 获取 TooltipHandler\n   * @returns\n   */\n  getTooltipHandler(): ITooltipHandler | undefined {\n    const tooltip = this._getTooltipComponent();\n    if (tooltip) {\n      return tooltip.tooltipHandler;\n    }\n    return this._context.tooltipHandler;\n  }\n\n  /**\n   * 手动调用展示 tooltip\n   * @param datum 原始数据\n   * @param options\n   * @returns\n   */\n  showTooltip(datum: Datum, options: IShowTooltipOption): boolean {\n    const tooltip = this._getTooltipComponent();\n    return (isValid(datum) && tooltip?.showTooltip(datum, options) !== 'none') ?? false;\n  }\n\n  /**\n   * 手动调用，关闭 tooltip\n   * @returns\n   */\n  hideTooltip(): boolean {\n    const tooltip = this._getTooltipComponent();\n    return tooltip?.hideTooltip() ?? false;\n  }\n\n  // 图例相关 api\n  /**\n   * 根据图例组件 id 获取图例数据\n   * @param id 组件 id\n   * @returns\n   */\n  getLegendDataById(id: string) {\n    const legendComponent = this._chart?.getComponentByUserId(id) as ILegend;\n    if (legendComponent) {\n      return legendComponent.getLegendData();\n    }\n    return [];\n  }\n\n  /**\n   * 根据图例组件索引获取图例数据\n   * @param index 图例索引，默认为 0\n   * @returns\n   */\n  getLegendDataByIndex(index: number = 0) {\n    const legends = this._chart\n      ?.getAllComponents()\n      .filter(c => c.type === ComponentTypeEnum.discreteLegend) as ILegend[];\n\n    if (legends[index]) {\n      return legends[index].getLegendData();\n    }\n\n    return [];\n  }\n\n  /**\n   * 根据图例组件 id 获取当前图例的选中项\n   * @param id 组件 id\n   * @returns\n   */\n  getLegendSelectedDataById(id: string) {\n    const legendComponent = this._chart?.getComponentByUserId(id) as ILegend;\n    if (legendComponent) {\n      return legendComponent.getSelectedData();\n    }\n    return [];\n  }\n\n  /**\n   * 根据图例组件索引获取当前图例的选中项\n   * @param index 图例索引，默认为 0\n   * @returns\n   */\n  getLegendSelectedDataByIndex(index: number = 0) {\n    const legends = this._chart\n      ?.getAllComponents()\n      .filter(c => c.type === ComponentTypeEnum.discreteLegend) as ILegend[];\n\n    if (legends[index]) {\n      return legends[index].getSelectedData();\n    }\n\n    return [];\n  }\n\n  /**\n   * 根据图例组件 id 更新图例选中数据\n   * @param id\n   * @returns\n   */\n  setLegendSelectedDataById(id: string, selectedData: StringOrNumber[]) {\n    const legendComponent = this._chart?.getComponentByUserId(id) as ILegend;\n    if (legendComponent) {\n      legendComponent.setSelectedData(selectedData);\n    }\n  }\n\n  /**\n   * 根据图例组件索引更新图例选中数据\n   * @param index 图例索引，默认为 0\n   * @returns\n   */\n  setLegendSelectedDataByIndex(index: number = 0, selectedData: StringOrNumber[]) {\n    const legends = this._chart\n      ?.getAllComponents()\n      .filter(c => c.type === ComponentTypeEnum.discreteLegend) as ILegend[];\n\n    if (legends[index]) {\n      legends[index].setSelectedData(selectedData);\n    }\n  }\n\n  // 保存图片相关的方法\n  /**\n   * **异步方法**返回一个包含图片展示的 data URI。\n   * @returns data URI\n   */\n  async getDataURL() {\n    const stage = this.getStage();\n    if (this._chart && stage) {\n      // 因为 vrender 是 autoRender 的，它不能确认第几帧才是完整的图表，所以这里调用一次 render 以保证获取到的是完整的画布\n      stage.render();\n      const canvas = this._chart.getCanvas();\n      const url = await getCanvasDataURL(canvas, {\n        onError: this._onError\n      });\n      return url;\n    }\n    this._option?.onError(new ReferenceError(`render is not defined`));\n\n    return null;\n  }\n\n  /**\n   * **异步方法** 导出图表图片，只支持浏览器端。\n   * @param name 保存的图片名称\n   * @returns\n   */\n  async exportImg(name?: string) {\n    if (!isTrueBrowser(this._option.mode)) {\n      this._option?.onError(new TypeError(`non-browser environment can not export img`));\n      return;\n    }\n\n    const dataURL = await this.getDataURL();\n    if (dataURL) {\n      URLToImage(name, dataURL);\n    } else {\n      this._option?.onError(new ReferenceError(`render is not defined`));\n    }\n  }\n  /**\n   * 导出绘制了图表内容的 canvas\n   * @returns HTMLCanvasElement\n   */\n  exportCanvas(): HTMLCanvasElement | undefined {\n    const stage = this.getStage();\n    if (this._chart && stage) {\n      return stage.toCanvas();\n    }\n    this._option?.onError(new ReferenceError(`render is not defined`));\n    return undefined;\n  }\n\n  /**\n   * 目前仅支持 node 环境，用于 node 端的图片导出\n   * @returns\n   */\n  getImageBuffer() {\n    if (this._option.mode !== 'node') {\n      this._option?.onError(new TypeError('getImageBuffer() now only support node environment.'));\n      return;\n    }\n    const stage = this.getStage();\n    if (stage) {\n      stage.render();\n      const buffer = stage.window.getImageBuffer();\n      return buffer;\n    }\n    this._option?.onError(new ReferenceError(`render is not defined`));\n\n    return null;\n  }\n\n  // 布局相关的方法\n  /**\n   * 设置自定义布局\n   */\n  setLayout(layout: LayoutCallBack) {\n    this._option.layout = layout;\n    this._chart?.setLayout(layout);\n  }\n  /**\n   * 强制重新布局\n   */\n  reLayout() {\n    this._chart?.setLayoutTag(true);\n  }\n\n  /**\n   * 获取编译器实例\n   * @returns\n   */\n  getCompiler() {\n    return this._compiler;\n  }\n\n  /**\n   * Get the chart instance\n   * 获取 Chart 图表实例。\n   * @returns Chart 实例\n   */\n  getChart() {\n    return this._chart;\n  }\n\n  /**\n   * Get the renderer instance.\n   * 获取渲染引擎实例。\n   * @returns the instance of VRender Stage\n   */\n  getStage(): Stage {\n    return this._compiler.getStage();\n  }\n\n  /**\n   * 获取 canvas dom\n   * @returns HTMLCanvasElement | undefined\n   */\n  getCanvas(): HTMLCanvasElement | undefined {\n    return this._compiler?.getCanvas();\n  }\n\n  /**\n   * 获取图表的 dom 容器\n   * @returns\n   */\n  getContainer(): Maybe<HTMLElement> {\n    // 用户传入 dom container\n    if (isValid(this._container)) {\n      return this._container;\n    }\n\n    // 用户传入 canvas\n    let canvasNode: Maybe<HTMLCanvasElement>;\n    if (isString(this._canvas)) {\n      canvasNode = document?.getElementById(this._canvas) as HTMLCanvasElement;\n    } else {\n      canvasNode = this._canvas as HTMLCanvasElement;\n    }\n    if (isValid(canvasNode)) {\n      return canvasNode.parentElement;\n    }\n\n    // 用户传入 stage\n    return this.getCanvas()?.parentElement;\n  }\n\n  /**\n   * 获取图表所有的组件实例\n   * @returns 组件实例\n   */\n  getComponents() {\n    return this._chart.getAllComponents();\n  }\n\n  /**\n   * setDimensionIndex could trigger mark state, tooltip, crosshair\n   * @param value dimension value\n   * @param opt option for set trigger\n   */\n  setDimensionIndex(value: StringOrNumber, opt: DimensionIndexOption = {}) {\n    return this._chart?.setDimensionIndex(value, opt);\n  }\n\n  /** 停止正在进行的所有动画 */\n  stopAnimation() {\n    this._compiler?.getVGrammarView()?.animate?.stop();\n  }\n\n  /** 暂停正在进行的所有动画 */\n  pauseAnimation() {\n    this._compiler?.getVGrammarView()?.animate?.pause();\n  }\n\n  /** 恢复暂停时正在进行的所有动画 */\n  resumeAnimation() {\n    this._compiler?.getVGrammarView()?.animate?.resume();\n  }\n\n  // TODO: 后续需要考虑滚动场景\n  /**\n   * Convert the data corresponding to the graph into coordinates\n   * 将图形对应的数据转换为坐标，该数据需要从传入图表的数据集中获取，如果数据不存在数据集中，可以使用 `convertValueToPosition` 方法\n   * @param datum 要转化的数据 the datum（from data source）to convert\n   * @param dataLinkInfo 数据的绑定信息，the data link info, could be seriesId or seriesIndex, default is { seriesIndex: 0 }\n   * @param isRelativeToCanvas 是否相对画布坐标 Whether relative to canvas coordinates\n   * @returns\n   */\n  convertDatumToPosition(\n    datum: Datum,\n    dataLinkInfo: DataLinkSeries = {},\n    isRelativeToCanvas: boolean = false\n  ): IPoint | null {\n    if (!this._chart) {\n      return null;\n    }\n    if (isEmpty(datum)) {\n      return null;\n    }\n    const { seriesId, seriesIndex = 0 } = dataLinkInfo;\n\n    let series: ISeries;\n    if (isValid(seriesId)) {\n      series = this._chart.getSeriesInUserId(seriesId);\n    } else if (isValid(seriesIndex)) {\n      series = this._chart.getSeriesInIndex([seriesIndex])?.[0];\n    }\n\n    if (series) {\n      const keys = Object.keys(datum);\n      const handledDatum = series\n        .getViewData()\n        // eslint-disable-next-line eqeqeq\n        .latestData.find((viewDatum: Datum) => keys.every(k => viewDatum[k] == datum[k]));\n      const seriesLayoutStartPoint = series.getRegion().getLayoutStartPoint();\n      let point: IPoint;\n      if (handledDatum) {\n        point = series.dataToPosition(handledDatum);\n      } else {\n        point = series.dataToPosition(datum);\n      }\n      return convertPoint(point, seriesLayoutStartPoint, isRelativeToCanvas);\n    }\n\n    return null;\n  }\n\n  // TODO: 1. 后续需要考虑滚动场景 2. 极坐标场景支持\n  convertValueToPosition(\n    value: StringOrNumber,\n    dataLinkInfo: DataLinkAxis,\n    isRelativeToCanvas?: boolean\n  ): number | null;\n  convertValueToPosition(\n    value: [StringOrNumber, StringOrNumber],\n    dataLinkInfo: DataLinkSeries,\n    isRelativeToCanvas?: boolean\n  ): IPoint | null;\n  convertValueToPosition(\n    value: StringOrNumber | [StringOrNumber, StringOrNumber],\n    dataLinkInfo: DataLinkAxis | DataLinkSeries,\n    isRelativeToCanvas: boolean = false\n  ): number | IPoint | null {\n    if (!this._chart || isNil(value) || isEmpty(dataLinkInfo)) {\n      return null;\n    }\n\n    if (!isArray(value)) {\n      // 如果单个值，则默认使用 axis 绑定信息\n      const { axisId, axisIndex } = dataLinkInfo as DataLinkAxis;\n      let axis;\n      if (isValid(axisId)) {\n        axis = this._chart.getComponentsByKey('axes').find(s => s.userId === axisId);\n      } else if (isValid(axisIndex)) {\n        axis = this._chart.getComponentsByKey('axes')?.[axisIndex];\n      }\n      if (!axis) {\n        warn('Please check whether the `axisId` or `axisIndex` is set!');\n        return null;\n      }\n\n      const pointValue = (axis as IAxis)?.valueToPosition(value);\n      if (isRelativeToCanvas) {\n        const axisLayoutStartPoint = axis.getLayoutStartPoint();\n        const axisOrient = (axis as IAxis).getOrient();\n        return (\n          pointValue +\n          (axisOrient === 'bottom' || axisOrient === 'top' ? axisLayoutStartPoint.x : axisLayoutStartPoint.y)\n        );\n      }\n\n      return pointValue;\n    }\n    const { seriesId, seriesIndex } = dataLinkInfo as DataLinkSeries;\n    let series;\n    if (isValid(seriesId)) {\n      series = this._chart.getSeriesInUserId(seriesId);\n    } else if (isValid(seriesIndex)) {\n      series = this._chart.getSeriesInIndex([seriesIndex])?.[0];\n    }\n\n    if (!series) {\n      warn('Please check whether the `seriesId` or `seriesIndex` is set!');\n      return null;\n    }\n\n    return convertPoint(\n      (series as ISeries).valueToPosition(value[0], value[1]),\n      series.getRegion().getLayoutStartPoint(),\n      isRelativeToCanvas\n    );\n  }\n\n  /**\n   * 获取实例函数\n   * @param key 函数名称\n   * @returns\n   */\n  getFunction(key: string): Function | null {\n    return ExpressionFunction.instance().getFunction(key);\n  }\n\n  /**\n   * 注册实例函数（对内包装一层，区分名字，避免重名问题）\n   * @param key 函数名称\n   * @param fun 函数内容\n   * @returns\n   */\n  registerFunction(key: string, fun: Function) {\n    if (!key || !fun) {\n      return;\n    }\n    ExpressionFunction.instance().registerFunction(key, fun);\n  }\n\n  /**\n   * 注销实例函数\n   * @param key 函数名称\n   */\n  unregisterFunction(key: string) {\n    if (!key) {\n      return;\n    }\n    ExpressionFunction.instance().unregisterFunction(key);\n  }\n\n  /**\n   * 获取实例函数列表\n   * @returns\n   */\n  getFunctionList() {\n    return ExpressionFunction.instance().getFunctionNameList();\n  }\n\n  /** 设置运行时 spec */\n  setRuntimeSpec(spec: any) {\n    this._spec = spec;\n    this._updateSpecInfo();\n  }\n\n  private _initChartPlugin() {\n    const pluginList = Factory.getChartPlugins();\n    if (pluginList.length > 0) {\n      this._chartPlugin = new ChartPluginService(this);\n      this._chartPlugin.load(pluginList.map(p => new p()));\n      // 插件生命周期\n      this._chartPluginApply('onInit', this._spec);\n    }\n  }\n\n  private _chartPluginApply(funcName: keyof IChartPluginService, ...args: any[]) {\n    if (!this._chartPlugin || !this._chartPlugin[funcName]) {\n      return;\n    }\n    (this._chartPlugin[funcName] as (...args: any[]) => any).apply(this._chartPlugin, args);\n  }\n}\n\nexport const registerVChartCore = () => {\n  // install region module\n  Factory.registerRegion('region', Region);\n  // install layout module\n  Factory.registerLayout('base', Layout);\n  // install essential marks\n  registerGroupMark();\n  // install essential vgrammar transform\n  View.useRegisters([registerFilterTransform, registerMapTransform]);\n  // install animation\n  registerVGrammarCommonAnimation();\n  // install default theme\n  registerTheme(darkTheme.name, darkTheme);\n  // set default logger level to Level.error\n  Logger.getInstance(LoggerLevel.Error);\n};\n\nregisterVChartCore();\n"]}