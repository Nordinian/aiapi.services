# Stripe 支付方式配置指南

## 概述

我们的系统现在支持 11 种主流支付方式，包括传统银行卡、数字钱包、以及加密货币支付。本文档详细说明如何在 Stripe 控制台中启用这些支付方式。

## 支持的支付方式

### 1. 银行卡支付 (Card)

- **类型**: 信用卡/借记卡
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用**: 默认启用，无需额外配置
- **支持地区**: 全球

### 2. 支付宝 (Alipay)

- **类型**: 中国数字钱包
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用步骤**:
  1. 登录 Stripe 控制台
  2. 导航到 **设置** → **支付方式**
  3. 找到 "Alipay" 并点击 **启用**
- **支持地区**: 主要面向中国用户

### 3. 微信支付 (WeChat Pay)

- **类型**: 中国数字钱包
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用步骤**:
  1. 在 Stripe 控制台启用 WeChat Pay
  2. 可能需要额外的商户审核
- **支持地区**: 主要面向中国用户

### 4. 稳定币支付 (Crypto)

- **类型**: 加密货币 (USDC, USDT 等)
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用步骤**:
  1. 确保你的 Stripe 账户位于**美国**实体公司
  2. 导航到 **设置** → **支付方式**
  3. 找到 "Pay with Crypto" 并申请启用
  4. 等待 Stripe 审核通过
- **优势**:
  - 直接以美元结算
  - 规避汇率风险
  - 支持 USDC、USDT 等主流稳定币

### 5. PayPal 支付

- **类型**: 全球数字钱包
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用步骤**:
  1. 在 Stripe 控制台启用 PayPal
  2. 可能需要额外的商户审核
  3. 确保业务类型符合 PayPal 政策
- **支持地区**: 全球 (200+ 个国家/地区)
- **优势**:
  - 全球用户基数庞大
  - 信任度高，转化率好
  - 支持多种货币

### 6. Stripe Link

- **类型**: 快速结账服务
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用**: 通常自动启用
- **优势**: 用户无需重复输入支付信息

### 7. Amazon Pay

- **类型**: 数字钱包
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用步骤**:
  1. 在 Stripe 控制台启用 Amazon Pay
  2. 可能需要与 Amazon 的集成审核
- **支持地区**: 主要面向北美、欧洲用户

### 8. Cash App Pay

- **类型**: 美国数字钱包
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用步骤**:
  1. 在 Stripe 控制台启用 Cash App Pay
- **支持地区**: 主要面向美国用户

### 9. Click to Pay

- **类型**: 银行卡快速支付
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用**: 通常与银行卡支付一起启用
- **优势**: 简化银行卡支付流程

### 10. Google Pay

- **类型**: 数字钱包
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用步骤**:
  1. 在 Stripe 控制台启用 Google Pay
  2. 配置域名验证
- **支持地区**: 全球

### 11. Apple Pay

- **类型**: 数字钱包
- **费率**: 2.9% + $0.30 每笔成功交易
- **启用步骤**:
  1. 在 Stripe 控制台启用 Apple Pay
  2. **重要**: 需要验证域名 `aiapi.services`
  3. 下载并托管 Apple 的域名验证文件
- **支持地区**: 全球 (主要是 iOS 设备)

## 配置步骤

### 步骤 1: 登录 Stripe 控制台

访问 [https://dashboard.stripe.com](https://dashboard.stripe.com) 并登录你的账户。

### 步骤 2: 导航到支付方式设置

1. 点击左侧菜单的 **设置** (Settings)
2. 选择 **支付方式** (Payment methods)

### 步骤 3: 启用所需的支付方式

对于每种支付方式：

1. 找到对应的支付方式选项
2. 点击 **启用** 或 **配置**
3. 按照提示完成设置

### 步骤 4: 特殊配置

#### Apple Pay 域名验证

1. 在 Apple Pay 设置中下载域名验证文件
2. 将文件上传到 `https://aiapi.services/.well-known/apple-developer-merchantid-domain-association`
3. 确保文件可以被公开访问

#### 稳定币支付 (重要)

1. 确保 Stripe 账户关联的是**美国实体公司**
2. 提交必要的 KYC 文档
3. 等待 Stripe 的加密货币功能审核

## 测试配置

### 测试环境

在测试模式下，你可以使用以下测试数据：

- **测试银行卡**: `4242 4242 4242 4242`
- **测试支付宝**: 使用 Stripe 提供的测试二维码
- **测试稳定币**: 使用 Stripe 的测试钱包地址

### 生产环境验证

1. 启用所有支付方式后，创建一个小额测试订单
2. 逐一测试每种支付方式
3. 确认 Webhook 正常接收支付状态

## 费用优化建议

### 支付方式优先级

为了降低交易成本，建议按以下优先级引导用户：

1. **Stripe Link** - 最快速
2. **银行卡直付** - 最通用
3. **数字钱包** (Apple Pay, Google Pay) - 用户体验好
4. **PayPal** - 全球信任度高，转化率好
5. **稳定币** - 适合加密货币用户
6. **地区性钱包** (支付宝、微信支付) - 针对特定地区

### 动态费率

考虑根据支付金额设置不同的费率策略：

- 小额支付: 优先推荐低费率方式
- 大额支付: 优先推荐稳定币 (规避汇率风险)

## 监控与分析

### 关键指标

在 Stripe 控制台监控以下指标：

- 各支付方式的成功率
- 用户偏好分布
- 交易量和费用分析
- 失败原因分析

### 优化建议

- 根据用户地理位置动态显示支付方式
- 定期分析支付数据，调整支付方式优先级
- 关注新兴支付方式的支持情况

## 故障排查

### 常见问题

1. **支付方式不显示**: 检查 Stripe 控制台是否正确启用
2. **Apple Pay 失败**: 验证域名验证文件是否正确配置
3. **稳定币不可用**: 确认账户资质和地区限制
4. **微信支付失败**: 检查用户地区和网络环境

### 联系支持

如遇到配置问题，可通过以下方式获取帮助：

- Stripe 技术支持: [https://support.stripe.com](https://support.stripe.com)
- 开发者文档: [https://docs.stripe.com](https://docs.stripe.com)

## 更新日志

- **2025-01-XX**: 初始版本，支持 10 种主流支付方式
- **2025-01-XX**: 添加稳定币支付支持
- **2025-01-XX**: 优化支付方式配置流程
